<!doctype html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    

    <title>Zabbix FQA | Let&#39;s Go</title>
    <meta property="og:title" content="Zabbix FQA - Let&#39;s Go">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2018-12-24T16:53:20&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2018-12-24T16:53:20&#43;08:00'>
        
    <meta name="Keywords" content="postgres 、python、pg 、linix 、docker、 kubernetes、 cloud、hadoop、promethues ">
    <meta name="description" content="Zabbix FQA">
        
    <meta name="author" content="Eamon">
    <meta property="og:url" content="https://zhangeamon.top/monitor/zabbix-fqa.html">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
        <link rel="stylesheet" href='/css/douban.css'>
    
        <link rel="stylesheet" href='/css/other.css'>
    
   
        <a href=https://github.com/eamonzhang><img style="position: absolute; top: 0; left: 0; border: 0;" src="/images/forkme_left_red_aa0000.png" alt="Fork me on GitHub" data-canonical-src="images/forkme_left_red_aa0000.png"></a>

   
        <script>
          var _hmt = _hmt || [];
            (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?1f6605a363a50554aa03adcc685b7699";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
          })();
       </script>
</head>

<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zhangeamon.top">
                        Let&#39;s Go
                    </a>
                
                <p class="description">Let&#39;s build our own cloud native together  </p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zhangeamon.top">首页</a>
                    
                    <a  href="https://zhangeamon.top/archives.html" title="归档">归档</a>
                    
                    <a  href="https://zhangeamon.top/postgresql.html" title="Postgres">Postgres</a>
                    
                    <a  href="https://zhangeamon.top/test/" title="test">test</a>
                    
                    <a  href="https://zhangeamon.top/about.html" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    

    <article class="post">
        <header>
            <h1 class="post-title">Zabbix FQA</h1>
        </header>
        <date class="post-meta meta-date">
            2018年12月24日
        </date>
        
        
        
        <div class="post-content">
            <h4 id="如何使用篇">如何使用篇</h4>
<hr>
<ul>
<li>如何安装</li>
</ul>
<p><a href="https://www.zabbix.com/download?zabbix=4.0&amp;os_distribution=centos&amp;os_version=7&amp;db=PostgreSQL">安装文档</a></p>
<p>架构模型为服务端、被监控端。<br>
被监控端agent安装在需要被监控的主机上，负责收集被监控主机相关状态的信息指标如内存，cup，网络等。<br>
服务端负责汇总所有agent的信息，如存储，处理，展现。数据存放在指定的数据库中如mysql pg。</p>
<p>需安装软件说明</p>
<p>zabbix-server-pgsql 服务端<br>
zabbix-web-pgsql    服务端界面<br>
zabbix-agent        被监控端，与被监控端安装在一起</p>
<ul>
<li>常用模块说明</li>
</ul>
<pre><code>Administration
   Users 新建属于自己的用户，禁用guest，慎用admin
      user 用户名 密码
      media 接收信息
      premissions 权限

   Media type 媒体类型，用于配置发送报警媒介， Email或自定义脚本
     Email 配置系统发送邮件 163为例 
            Name email
            Type Email
            SMTP server smtp.163.com
SMTP server port 25
     SMTP helo   smtp.163.com
     SMTP email  注册的邮箱地址
       Username  注册的用户名
       password  密码

Configuration 
   Hosts 管理被监控的主机
     host 配置被监控的主机
     Templates 监控的内容模版
   Actions 触发报警时的动作，一般给管理员方法信息
   Discovery 自动发现

Monitoring

</code></pre><h4 id="fqa">FQA</h4>
<ul>
<li>Too Many Process</li>
</ul>
<p>原因: 被监控的主机进程数过多或默认的触发条件过低
分析:</p>
<pre><code>获取当前进程数 ， 127.0.0.1 改为对应节点IP
zabbix_get -s 127.0.0.1 -k 'proc.num[]'  

查询是哪个应用占有的,如查看zabbix-agent占有进程数量
zabbix_get -s 127.0.0.1 -k 'proc.num[zabbix]'

比较有效的方法,将zabbix 换成想要查看的应用

ps -ef | wc
ps -ef | grep zabbix | wc  

</code></pre><p><a href="https://www.zabbix.com/documentation/4.0/zh/manual/appendix/items/proc_mem_num_notes?s%5B%5D=proc&amp;s%5B%5D=num">更多</a></p>
<p>默认的触发值过低300 在实际的生产环境中改为1000</p>
<ul>
<li>zabbix poller processes more than 75% busy</li>
</ul>
<p>原因: 当被监控的主机逐渐增多时。zabbix server 端如果采用被动模式时，server 主机的性能会遇到瓶颈。</p>
<p>处理方法:  StartPollers 增加</p>
<p>vi zabbix_server.conf</p>
<pre><code>### Option: StartPollers
#       Number of pre-forked instances of pollers.
#
# Mandatory: no
# Range: 0-1000
# Default:
# StartPollers=5
StartPollers=20
</code></pre><p>注意观察数据库连接数</p>
<ul>
<li>修改数据库连接配置</li>
</ul>
<pre><code>vi /etc/zabbix/web/zabbix.conf.php

</code></pre>
        </div>

        


        

<div class="post-archive">
    <h2>其他文章</h2>
    <ul class="listing">
        
        <li><a href="/linux/kworker.html">Kworker </a></li>
        
        <li><a href="/postgres/index-invalid.html">引起索引失效</a></li>
        
        <li><a href="/linux/stat.html">Access Modify Change 三种时间戳</a></li>
        
    </ul>
</div>



        <div class="post-meta meta-tags">
            
            没有标签
            
        </div>
    </article>
    
    

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "your github repo"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2018 - 2021 <a href="https://zhangeamon.top"> By Eamon</a>
        
    </div>
    <br />
  
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>






    <script src='/js/douban.js'></script>


                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zhangeamon.top/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zhangeamon.top">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zhangeamon.top/linux/github-dns.html" title="Github DNS 加速">Github DNS 加速</a>
    </li>
    
    <li>
        <a href="https://zhangeamon.top/postgres/replication02.html" title="流复制同步级别">流复制同步级别</a>
    </li>
    
    <li>
        <a href="https://zhangeamon.top/redis/redis-scence.html" title="Redis 应用场景">Redis 应用场景</a>
    </li>
    
    <li>
        <a href="https://zhangeamon.top/storage/rclone.html" title="云存储同步 rclone">云存储同步 rclone</a>
    </li>
    
    <li>
        <a href="https://zhangeamon.top/postgres/pg_rman.html" title="pg_rman 备份恢复数据库">pg_rman 备份恢复数据库</a>
    </li>
    
    <li>
        <a href="https://zhangeamon.top/postgres/patroni02.html" title="Patroni 高可用管理进阶">Patroni 高可用管理进阶</a>
    </li>
    
    <li>
        <a href="https://zhangeamon.top/postgres/thinking_in_db_performance.html" title="数据库优化思考-性能优化">数据库优化思考-性能优化</a>
    </li>
    
    <li>
        <a href="https://zhangeamon.top/monitor/smapler.html" title="Smapler">Smapler</a>
    </li>
    
    <li>
        <a href="https://zhangeamon.top/linux/git-objects-clean.html" title="Git 文件过大清理">Git 文件过大清理</a>
    </li>
    
    <li>
        <a href="https://zhangeamon.top/postgresql.html" title="Postgres  数据库">Postgres  数据库</a>
    </li>
    
</ul>

    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href='/categories.html'>分类</a></h3>
<ul class="widget-list">
    
    <li><a href="https://zhangeamon.top/categories/Golang.html">Golang (3)</a></li>
    
    <li><a href="https://zhangeamon.top/categories/postgres.html">postgres (1)</a></li>
    
</ul>

    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags.html'>标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zhangeamon.top/tags/golang.html">golang</a>
    
    <a href="https://zhangeamon.top/tags/postgres.html">postgres</a>
    
    <a href="https://zhangeamon.top/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html">性能优化</a>
    
</div>

    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="http://www.cnblogs.com/zhangeamon" title="历史博客">历史博客</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zhangeamon.top/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
   
</body>

</html>
