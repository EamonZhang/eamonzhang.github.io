<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>postgres on Let&#39;s go ğŸŒ ğŸŒ ğŸŒ</title>
    <link>https://zhangeamon.top/categories/postgres/</link>
    <description>Recent content in postgres on Let&#39;s go ğŸŒ ğŸŒ ğŸŒ</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <lastBuildDate>Wed, 23 Mar 2022 14:41:44 +0800</lastBuildDate><atom:link href="https://zhangeamon.top/categories/postgres/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>æ•°æ®åº“å…å¯†ç ç™»é™†</title>
      <link>https://zhangeamon.top/postgres/login_nopasswd/</link>
      <pubDate>Wed, 23 Mar 2022 14:41:44 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/login_nopasswd/</guid>
      <description>å…å¯†ç™»é™† ä»¥ä¸‹å‡ ç§PGé…ç½®å…å¯†çš„æ–¹æ³•ã€‚ æ–¹æ³•ä¸€ï¼šè®¾ç½®pg_hab.conf è®¤è¯æ–¹å¼ä¸ºtrust #Type database user address method host all postgres 127.0.0.1/32 trust è¯¥æ–¹å¼æœ€ä¸å®‰å…¨ï¼Œå¯¼è‡´é€šè¿‡æŒ‡å®šIPè¿æ¥æ•°æ®åº“çš„è¿æ¥éƒ½å¯ä»¥ä»»æ„ç™»å½•æ•°æ®ï¼Œæ¯«æ— å®‰å…¨ä¿éšœã€‚ç¦æ­¢åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚ æ–¹æ³•äºŒï¼šè®¾ç½®PGç¯å¢ƒå˜é‡PGPASSWORD PGPASSWORDæ˜¯P</description>
    </item>
    
    <item>
      <title>vacuum é™æµ</title>
      <link>https://zhangeamon.top/postgres/vacuum_limit/</link>
      <pubDate>Fri, 11 Feb 2022 13:51:50 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/vacuum_limit/</guid>
      <description>é™æµç›®çš„ æ¸…ç†æ˜¯åœ¨åå°è¿è¡Œçš„ç»´æŠ¤ä»»åŠ¡ï¼Œå¯¹ç”¨æˆ·æŸ¥è¯¢çš„å½±å“æœ€å°ã€‚ä¸åº”è¯¥æ¶ˆè€—å¤ªå¤šçš„èµ„æº(CPUå’Œç£ç›˜I/O)ã€‚ æ¸…ç†æˆæœ¬è®¡ç®— æ¸…ç†è¿‡ç¨‹ç›¸å½“ç®€å•ï¼Œå®ƒä»æ•°æ®æ–‡ä»¶ä¸­è¯»å–é¡µé¢(8kBçš„æ•°æ®å—)ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦éœ€è¦æ¸…ç†ã€‚å¦‚æœæ²¡æœ‰dead tuplesï¼Œé¡µé¢å°†è¢«ç®€å•åœ°ä¸¢å¼ƒï¼Œè€Œä¸è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚å¦åˆ™ï¼Œå®ƒå°†è¢«æ¸…ç†(</description>
    </item>
    
    <item>
      <title>æŸ¥çœ‹æ•°æ®ä¿¡æ¯å¸¸ç”¨sqlæ•´ç†</title>
      <link>https://zhangeamon.top/postgres/monitor-sql/</link>
      <pubDate>Thu, 10 Feb 2022 10:21:07 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/monitor-sql/</guid>
      <description>åº“å†…å­˜å‘½ä¸­ç‡ SELECT &#39;index hit rate&#39; AS name, (sum(idx_blks_hit)) / nullif(sum(idx_blks_hit + idx_blks_read),0) AS ratio FROM pg_statio_user_indexes UNION ALL SELECT &#39;table hit rate&#39; AS name, sum(heap_blks_hit) / nullif(sum(heap_blks_hit) + sum(heap_blks_read),0) AS ratio FROM pg_statio_user_tables; è¡¨å†…å­˜å‘½ä¸­ç‡ SELECT relname AS relation, heap_blks_read AS heap_read, heap_blks_hit AS heap_hit, ((heap_blks_hit*100) / NULLIF((heap_blks_hit + heap_blks_read), 0)) AS ratio FROM pg_statio_user_tables order by ratio; è¯»IOå†…å­˜å æ¯” ç£ç›˜ä¸­è¯»å–å’Œåœ¨å†…å­˜ä¸­ç›´æ¥è¯»å–ä¹‹é—´çš„æ•°å­—å’Œæ¯” SELECT relname AS &amp;quot;relation&amp;quot;, heap_blks_read AS heap_read, heap_blks_hit AS heap_hit, ( (heap_blks_hit*100) / NULLIF((heap_blks_hit + heap_blks_read), 0)) AS ratioFROM pg_statio_user_tables; è¡¨ä¸­ç´¢å¼•å‘½ä¸­ç‡ SELECT relname, CASE idx_scan WHEN 0 THEN NULL ELSE round(100.0 * idx_scan / (seq_scan + idx_scan), 5) END</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å®æ—¶è¿è¡Œä¿¡æ¯æŸ¥çœ‹</title>
      <link>https://zhangeamon.top/postgres/pg_activity/</link>
      <pubDate>Wed, 12 Jan 2022 15:47:07 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_activity/</guid>
      <description>ä»‹ç» ç±»ä¼¼Linux top å‘½ä»¤ æŸ¥çœ‹æ•°æ®å®æ—¶è¿è¡Œæƒ…å†µ https://github.com/dalibo/pg_activity å®‰è£… æµ‹è¯•ç¯å¢ƒcentos7 postgresql10 æŸ¥çœ‹å·²å®‰è£…çš„PGç‰ˆæœ¬ å¦‚æœæœ‰9.2 ç‰ˆæœ¬ï¼Œæ¸…ç†,å¦‚æœæ²¡æœ‰postgresql10-devel éœ€è¦å®‰è£… yum list installed | grep postgres è®¾ç½®ç¯å¢ƒå˜é‡ export PG_HOME=/usr/pgsql-10 export PATH=$PATH:$PG_HOME/bin/ å®‰è£…pg_activity python3 -m pip install pg_activity psycopg2-binary ä½¿ç”¨ ä¸psql è¿æ¥æ–¹å¼ç›¸åŒ pg_activity -U xxx -p xxx æ›´å¤š</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“çš„jsonç±»å‹</title>
      <link>https://zhangeamon.top/postgres/pg_json/</link>
      <pubDate>Mon, 20 Dec 2021 10:51:16 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_json/</guid>
      <description>json ä¸ jsonb json ä¿æŒåŸå§‹æ ¼å¼ï¼Œ jsonbæ˜¯è§£æè¾“å…¥åä¿å­˜çš„äºŒè¿›åˆ¶ï¼Œåœ¨è§£ææ—¶ä¼šè¿‡æ»¤æ‰ä¸å¿…è¦çš„ç©ºæ ¼å’Œé‡å¤çš„å¥ã€‚ SELECT &#39;{&amp;quot;name&amp;quot;: &amp;quot;zhangsan&amp;quot;, &amp;quot;age&amp;quot;: 17, &amp;quot;sex&amp;quot;:&amp;quot;m&amp;quot;,&amp;quot;age&amp;quot;:17.5}&#39;::json; json ------------------------------------------------------------ {&amp;quot;name&amp;quot;: &amp;quot;zhangsan&amp;quot;, &amp;quot;age&amp;quot;: 17, &amp;quot;sex&amp;quot;:&amp;quot;m&amp;quot;,&amp;quot;age&amp;quot;:17.5} SELECT &#39;{&amp;quot;name&amp;quot;: &amp;quot;zhangsan&amp;quot;, &amp;quot;age&amp;quot;: 17, &amp;quot;sex&amp;quot;:&amp;quot;m&amp;quot;,&amp;quot;age&amp;quot;:17.5}&#39;::jsonb; jsonb ----------------------------------------------- {&amp;quot;age&amp;quot;: 17.5, &amp;quot;sex&amp;quot;: &amp;quot;m&amp;quot;, &amp;quot;name&amp;quot;: &amp;quot;zhangsan&amp;quot;} json æ’å…¥å¯èƒ½ä¼šæ›´å¿«äº›ï¼Œjsonbçš„è¯»å–æ›´å¿« æ“ä½œç¬¦ json ,jsonb æ“ä½œç¬¦ æ“ä½œç¬¦ å³æ“ä½œæ•°ç±»å‹ æè¿° ç¤ºä¾‹ ç»“æœ -&amp;gt; int è·å–JSONæ•°ç»„å…ƒç´ ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰ select</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“æ—¥å¿—åˆ†æ</title>
      <link>https://zhangeamon.top/postgres/pg_elk/</link>
      <pubDate>Fri, 05 Nov 2021 09:44:17 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_elk/</guid>
      <description>æ•°æ®åº“æ—¥å¿—åˆ†æ æ•´ä½“æ¶æ„ filebeat -&amp;gt; logstash -&amp;gt; elasticseach -&amp;gt; kibana filebeat æ”¶é›†æ—¥å¿— logstash ä¸­è½¬åŠæ—¥å¿—è§„åˆ™åŒ¹é…è¿‡æ»¤ elasticsearch æ—¥å¿—å­˜å‚¨æ£€ç´¢åº“ kibana æŸ¥çœ‹ç•Œé¢ postgresql log_destination = &#39;csvlog&#39; logging_collector = &#39;on&#39; log_filename = &#39;postgresql-%Y-%m-%d_%H%M%S.log&#39; log_rotation_age = &#39;1d&#39; log_rotation_size = &#39;100MB&#39; log_min_messages = &#39;info&#39; log_min_duration_statement = &#39;1000&#39; log_statement = &#39;ddl&#39; filebeat filebeat.inputs: - type: log enabled: true paths: - /var/lib/pgsql/***/postgresql-*.csv fields: log_topics: postgresql multiline.pattern: &#39;^[[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}.[0-9]{3} [A-Z]{3}&#39; multiline.negate: true multiline.match: after filebeat.config.modules: path: ${path.config}/modules.d/*.yml reload.enabled: false setup.template.settings: index.number_of_shards: 1 tags: [&amp;quot;postgesql&amp;quot;] setup.kibana: output.logstash: hosts: [&amp;quot;*.*.*.*:5044&amp;quot;] processors: - add_host_metadata: ~ - add_cloud_metadata: ~ logstash # # this config is use for version logstash 7.3.1 # input { beats { port =&amp;gt; 5044 } #sdtin{ # #} } #</description>
    </item>
    
    <item>
      <title>å®¢æˆ·ç«¯æ•…éšœè½¬ç§»</title>
      <link>https://zhangeamon.top/postgres/libpg/</link>
      <pubDate>Thu, 22 Jul 2021 11:04:27 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/libpg/</guid>
      <description>å¤šä¸»æœºè¿æ¥ PostgreSQL libpq æ˜¯æ•°æ®åº“çš„ä¸€ä¸ªè¿æ¥é©±åŠ¨ï¼Œæ”¯æŒå¤šä¸»æœºé…ç½®ï¼ŒåŒæ—¶æ”¯æŒtarget_session_attrs ä¸»æœºè§’è‰²åˆ¤æ–­é…ç½®ã€‚ å½“é…ç½®äº†å¤šä¸ªä¸»æœºæ—¶ï¼Œä¼šæŒ‰é¡ºåºå°è¯•è¿æ¥ï¼Œä¹‹é“è·å–åˆ°æˆåŠŸçš„è¿æ¥ä¸ºæ­¢ã€‚ åˆ©ç”¨libpqçš„è¿™ä¸ªç‰¹æ€§ï¼Œç»“åˆæ•°æ®åº“è‡ªåŠ¨HAçš„ä¸€äº›è½¯ä»¶ï¼Œå¯ä»¥å®ç°åœ¨ä¸å¼•å…¥VIPä»¥åŠä¸­é—´è·¯ç”±èŠ‚ç‚¹çš„</description>
    </item>
    
    <item>
      <title>Django CONN_MAX_AGE å¯¹æ•°æ®è¿æ¥çš„å½±å“</title>
      <link>https://zhangeamon.top/python/django_max_con_age/</link>
      <pubDate>Tue, 20 Apr 2021 13:27:13 +0800</pubDate>
      
      <guid>https://zhangeamon.top/python/django_max_con_age/</guid>
      <description>Djangoçš„æ•°æ®åº“è¿æ¥ Djangoå¯¹æ•°æ®åº“çš„é“¾æ¥å¤„ç†æ˜¯è¿™æ ·çš„ï¼ŒDjangoç¨‹åºæ¥å—åˆ°è¯·æ±‚ä¹‹åï¼Œåœ¨ç¬¬ä¸€è®¿é—®æ•°æ®åº“çš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥,ç›´åˆ°è¯·æ±‚ç»“æŸï¼Œå…³é—­è¿æ¥ã€‚ä¸‹æ¬¡è¯·æ±‚ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å› æ­¤ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œéšç€è®¿é—®çš„å¹¶å‘æ•°è¶Šæ¥è¶Šé«˜ï¼Œå°±ä¼šäº§ç”Ÿå¤§é‡çš„æ•°æ®åº“è¿æ¥ ä½¿ç”¨CONN_MAX_AGEå‡</description>
    </item>
    
    <item>
      <title>PGé«˜å¯ç”¨ repmgr æ­å»º</title>
      <link>https://zhangeamon.top/postgres/repmgr/</link>
      <pubDate>Wed, 07 Apr 2021 10:12:02 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/repmgr/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Backgroud Writer è¿›ç¨‹</title>
      <link>https://zhangeamon.top/postgres/bgwriter/</link>
      <pubDate>Wed, 31 Mar 2021 15:13:50 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/bgwriter/</guid>
      <description>ä¸»è¦ä½œç”¨ è´Ÿè´£å°†shared buffer ä¸­çš„å†…å®¹åˆ·å†™åˆ°ç£ç›˜ä¸­ï¼Œ9.1ç‰ˆä¹‹åéƒ¨åˆ†å†…å®¹äº¤ç»™checkpointå®Œæˆã€‚ å‚æ•°é…ç½® # - Background Writer - #bgwriter_delay = 200ms # 10-10000ms between rounds #bgwriter_lru_maxpages = 100 # 0-1000 max buffers written/round #bgwriter_lru_multiplier = 2.0 # 0-10.0 multiplier on buffers scanned/round #bgwriter_flush_after = 512kB # measured in pages, 0 disables bgwriter_delay ä¸¤æ¬¡å†™å…¥ä»»åŠ¡ä¹‹é—´çš„ç¡çœ é—´éš”æ—¶é—´ bgwriter_lru_maxpages æ¯æ¬¡bgwriterä»»åŠ¡å†™bufferçš„æœ€å¤§pageæ•°ï¼Œä¸€æ—¦è¾¾</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“è¯•å›¾ä¹‹ pg_stat_bgwriter</title>
      <link>https://zhangeamon.top/postgres/view_pg_stat_bgwriter/</link>
      <pubDate>Wed, 31 Mar 2021 09:32:17 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/view_pg_stat_bgwriter/</guid>
      <description>ä»‹ç» å¯æŸ¥çœ‹ backgroud writerï¼Œ checkpoint ï¼Œbackend è¿›ç¨‹åˆ·å†™ Shared buffer æƒ…å†µè§†å›¾ pgæ•°æ®åº“åœ¨å†™å…¥æ—¶å…ˆåœ¨å†…å­˜ä¸­æ›´æ–°shared buffer ï¼Œç„¶åæœ‰checkpointæœºåˆ¶å°†è„æ•°æ®åˆ·å†™åˆ°ç£ç›˜ã€‚ è§†å›¾ select * from pg_stat_bgwriter ; -[ RECORD 1 ]---------+------------------------------ checkpoints_timed | 64017 checkpoints_req | 458 checkpoint_write_time | 9608302902 checkpoint_sync_time | 1189286 buffers_checkpoint | 578367652 buffers_clean | 329022 maxwritten_clean | 2353 buffers_backend | 29802728 buffers_backend_fsync | 0 buffers_alloc | 83826180 stats_reset | 2020-08-20 19:41:20.491551+08 è´Ÿè´£å°†shared buffer ä¸­çš„å†…å®¹</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“é«˜å¯ç”¨è®¾è®¡åˆ†æ</title>
      <link>https://zhangeamon.top/postgres/ha_fd/</link>
      <pubDate>Tue, 23 Mar 2021 16:32:14 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/ha_fd/</guid>
      <description>åŸºæœ¬æ¦‚å¿µ é›†ç¾¤ï¼š ä¸€ç»„å¤šä¸ªåŒæ—¶å¯¹å¤–æä¾›ç›¸åŒæœåŠ¡çš„å®ä½“æœºç»„æˆä¸€ä¸ªé›†ç¾¤ã€‚è¿™é‡Œçš„é›†ç¾¤ä¸ºä¸»ä»ç»“æ„ï¼Œå¯å†™èŠ‚ç‚¹ä¸ºä¸»èŠ‚ç‚¹ï¼Œå…¶ä»–åªè¯»èŠ‚ç‚¹ä¸ºä»èŠ‚ç‚¹ã€‚ é«˜å¯ç”¨ï¼š åœ¨å‘ç”Ÿå±€éƒ¨æ•…éšœæ—¶å¯¹æ•´ä½“ä¸šåŠ¡å½±å“å¾ˆä½ã€‚å³ä¸å¯ç”¨çš„æ—¶é—´è¦å°½é‡çš„çŸ­ã€‚ å¯¹å¤–éƒ¨åº”ç”¨çš„è®¿é—®æ¥è¯´ï¼Œæ— éœ€å…³æ³¨å¦‚ä½•å®ç°ï¼Œå¦‚åŒåªè®¿é—®ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¹¶èƒ½å¾—åˆ°æŒç»­çš„æœåŠ¡èƒ½åŠ›ã€‚</description>
    </item>
    
    <item>
      <title>pg_rman å¤‡ä»½æ¢å¤æ•°æ®åº“</title>
      <link>https://zhangeamon.top/postgres/pg_rman/</link>
      <pubDate>Tue, 09 Mar 2021 13:35:31 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_rman/</guid>
      <description>é€‚ç”¨åœºæ™¯ PG_RMAN åŸºäºæœ¬åœ°æ•°æ®æ‹·è´çš„æ–¹å¼ï¼Œè¦æ±‚ä¸æ•°æ®åº“éœ€è¦å®‰è£…åœ¨åŒä¸€ä¸ªæœºå™¨èŠ‚ç‚¹ä¸Šã€‚ é€‚ç”¨äºé¡¹ç›®åˆæœŸï¼Œå¯¹æ•°æ®åº“çš„è§„åˆ’å¤„äºåˆçº§é˜¶æ®µã€‚å®ä½“æœºä¸å……åˆ†çš„æƒ…å†µæ˜¯ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚ æ•°æ®åº“ä½¿ç”¨ssdç›˜ï¼Œå¤‡ä»½ç£ç›˜é‡‡ç”¨ä¼ä¸šsataå¤§ç›˜ã€‚æˆ–nfsç½‘ç›˜ç­‰ã€‚ PG_RMAN æ”¯æŒå…¨å¤‡ä»½ï¼Œå¢é‡å¤‡ä»½ï¼Œå¤‡ä»½éªŒè¯ï¼Œä¿ç•™ç­–ç•¥ç­‰ åº”ç”¨è½¯ä»¶åŒ…åœ°å€ https://github.com/ossc-db/pg_rman/releases åŸº</description>
    </item>
    
    <item>
      <title>Patroni é«˜å¯ç”¨ç®¡ç†è¿›é˜¶</title>
      <link>https://zhangeamon.top/postgres/patroni02/</link>
      <pubDate>Fri, 05 Mar 2021 17:06:18 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/patroni02/</guid>
      <description>å®Œæˆç›®æ ‡ ä¸»ä»åŒæ­¥ç­–ç•¥ å¼‚åœ°å¤šæœºæˆ¿ç­–ç•¥ failover è§¦å‘è¯¦æƒ… è®¿é—®è®¤è¯ watch-dog é…ç½®æ–‡ä»¶è¯¦æƒ… fencing DCS å¤±æ•ˆå¤„ç† åŠ å…¥èŠ‚ç‚¹å¤åˆ¶æ•°æ®é™æµ ä¸»ä»åˆ‡æ¢æµé‡,é¿å…é‡æ–°æ‹‰å– çº§è”å¤åˆ¶ callback æ—¥å¿—&amp;amp;ç›‘æ§ ä¸»ä»åŒæ­¥ç­–ç•¥ æ•°æ®åº“ä¸»ä»ä¹‹é—´åŒæ­¥ç±»å‹ Synchronous state of this standby server. Possible values are: async: This standby server is asynchronous. potential: This standby server is now asynchronous, but can potentially become synchronous if one of current synchronous ones fails. sync: This standby server is synchronous. quorum: This standby server is considered as</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ä¼˜åŒ–æ€è€ƒ-æ€§èƒ½ä¼˜åŒ–</title>
      <link>https://zhangeamon.top/postgres/thinking_in_db_performance/</link>
      <pubDate>Fri, 26 Feb 2021 13:33:23 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/thinking_in_db_performance/</guid>
      <description>ä¸ºä»€ä¹ˆè¦ä¼˜åŒ– é¦–å…ˆäº†è§£ä¸€ä¸ªæ¦‚å¿µï¼Œä»€ä¹ˆæ˜¯Â·ç†µå¢Â· ç‰©ç†å®šä¹‰ï¼šç†µå¢è¿‡ç¨‹æ˜¯ä¸€ä¸ªè‡ªå‘çš„ç”±æœ‰åºå‘æ— åºå‘å±•çš„è¿‡ç¨‹(Bortz, 1986; Roth, 1993) åœ¨ä¸€ä¸ªå­¤ç«‹çš„ç³»ç»Ÿé‡Œï¼Œå¦‚æœæ²¡æœ‰å¤–åŠ›åšå·¥ï¼Œå…¶æ€»æ··ä¹±åº¦ï¼ˆå³ç†µï¼‰ä¼šä¸æ–­å¢å¤§ï¼Œç›´è‡³ç³»ç»Ÿå½»åº•å˜å¾—æ— åº ä»ç³»ç»Ÿè½¯ä»¶çš„è§’åº¦ï¼š ä»åº”ç”¨ç³»ç»Ÿä¸Šçº¿é‚£ä¸€åˆ»å¼€å§‹ï¼Œéšç€ç”¨æˆ·é‡çš„å¢åŠ ã€ä¸šåŠ¡åŠŸèƒ½çš„æŒç»­</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ä¼˜åŒ–æ€è€ƒ - æ¨¡å—è°ƒä¼˜</title>
      <link>https://zhangeamon.top/postgres/thinking_in_db_tune/</link>
      <pubDate>Wed, 13 Jan 2021 09:04:35 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/thinking_in_db_tune/</guid>
      <description>å¼€å§‹ä¹±è¯´ ä¸»è¦æ˜¯ç»“åˆpostgresæ•°æ®åº“è‡ªèº«ç‰¹ç‚¹ï¼Œæ ¹æ®å…·ä½“çš„ä¸šåŠ¡åœºæ™¯ï¼Œä½œå‡ºç›¸åº”è°ƒæ•´ï¼Œä½¿å…¶æ›´åŠ åˆç†ã€‚ æ•°æ®åº“ä½œä¸ºä¸€ä¸ªæ•´ä½“å¯¹å¤–æä¾›æœåŠ¡ï¼Œå•æ˜¯å…¶å†…éƒ¨æ˜¯ç”±ä¸åŒçš„åŠŸèƒ½æ¨¡å—ç»„æˆï¼Œç›¸äº’åè°ƒæ¥å…±åŒå®Œæˆä»»åŠ¡ã€‚ å„ä¸ªåŠŸèƒ½æ¨¡å—å®Œæˆä¸åŒçš„åŠŸèƒ½ï¼Œæ¯ä¸ªæ¨¡å—çš„ç‰¹ç‚¹ä¹Ÿä¸åŒï¼Œåœ¨è°ƒæ•´çš„æ—¶å€™è‡³å°‘éœ€è¦ç†è§£å„ä¸ªæ¨¡å—å®ç°çš„åŸºæœ¬</description>
    </item>
    
    <item>
      <title>è¯¯æ“ä½œé—ªå›</title>
      <link>https://zhangeamon.top/postgres/reback/</link>
      <pubDate>Mon, 11 Jan 2021 17:19:06 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/reback/</guid>
      <description>åŸç† åˆ©ç”¨mvccåŸç†ï¼Œæ•°æ®åœ¨åˆ é™¤æˆ–æ›´æ–°æ—¶åªæ˜¯æ ‡è®°ä¸ºåˆ é™¤ã€‚å½“æ²¡æœ‰å‘ç”Ÿè¿‡gcæ—¶å†å²æ•°æ®ä»ç„¶å­˜åœ¨ã€‚åªæ˜¯å¯¹å½“å‰äº‹åŠ¡ä¸å¯è§ã€‚ é€šè¿‡ä¿®æ”¹å½“å‰äº‹åŠ¡å·ä¸ºè¯¯æ“ä½œå‰çš„äº‹åŠ¡å·å°±å¯ä»¥çœ‹åˆ°å†å²æ•°æ®ã€‚ ä¾‹å¦‚ T1 ï¼ˆæ·»åŠ æ•°æ®ï¼‰ T2 - T8ï¼ˆå…¶ä»–æ“ä½œï¼‰ T9ï¼ˆåˆ é™¤äº†T1åŠ å…¥çš„æ•°æ®ï¼‰T10&amp;hellip; (å…¶ä»–æ“ä½œ)ã€‚ è‡ªéœ€è¦å°†</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ä¼˜åŒ–æ€è€ƒ - ç»“æ„è®¾è®¡</title>
      <link>https://zhangeamon.top/postgres/thinking_in_db_fd/</link>
      <pubDate>Mon, 11 Jan 2021 10:10:42 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/thinking_in_db_fd/</guid>
      <description>DB ä¸ APP çš„ä¸åŒ æœ‰æ— çŠ¶æ€ æ— çŠ¶æ€åº”ç”¨ï¼Œæ¯ä¸ªå®ä¾‹æä¾›çš„æœåŠ¡éƒ½æ˜¯ç­‰ä»·ã€å¯¹ç­‰çš„ã€‚APP åº”ç”¨ä¸ºæ— çŠ¶æ€åº”ç”¨ï¼ŒDBåº”ç”¨ä¸ºæœ‰çŠ¶æ€åº”ç”¨ã€‚ æ•°æ®åº“æ­£æ˜¯å› ä¸ºæœ‰çŠ¶æ€ï¼Œæ‰€ä»¥ç»´æŠ¤èµ·æ¥æ›´æœ‰æŒ‘æˆ˜ã€‚ APP åœ¨é¢å¯¹å¤§é‡é«˜å¹¶å‘è¯·æ±‚æ—¶å¯ä»¥æ— æ‰€é¡¾åŠçš„å¢åŠ å®ä¾‹ï¼ŒåŠ æœºå™¨è¿›è¡Œæ‰©å®¹ã€‚å¤„ç†èƒ½é‡Œä¹Ÿä¼šå°†å¾—åˆ°çº¿æ€§æå‡ã€‚ç®€å•ç²—æš´åˆæœ‰æ•ˆã€‚ DB é¢å¯¹åŒæ ·çš„å‹</description>
    </item>
    
    <item>
      <title>auto vacuum è§¦å‘æœºåˆ¶</title>
      <link>https://zhangeamon.top/postgres/auto_vacuum_trigger/</link>
      <pubDate>Fri, 08 Jan 2021 09:20:56 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/auto_vacuum_trigger/</guid>
      <description>æ•°æ®åº“è‡ªåŠ¨åƒåœ¾å›æ”¶è§¦å‘æ¡ä»¶åˆ†æ åœ¨postgres ä¸­ åƒåœ¾å›æ”¶çš„é‡è¦æ„ä¹‰åŠåœ¨æ‰§è¡Œåƒåœ¾å›æ”¶æ—¶å…·ä½“éƒ½åšäº†äº›ä»€ä¹ˆå¾ˆå¤šåœ°æ–¹éƒ½æœ‰ä»‹ç»ã€‚ ä½†æ˜¯ä½•æ—¶è§¦å‘åƒåœ¾å›æ”¶ï¼Œå³åƒåœ¾å›æ”¶çš„è§¦å‘æ¡ä»¶æ˜¯ä»€ä¹ˆã€‚ å®˜ç½‘çš„ä»‹ç»ä¸€èˆ¬æ˜¯æœ‰å¦‚ä¸‹å‡ ä¸ªå‚æ•°å†³å®š #autovacuum = on # Enable autovacuum subprocess? &#39;on&#39; #autovacuum_vacuum_threshold = 50 # min number of row updates before vacuum #autovacuum_analyze_threshold = 50 # min number of row updates before analyze #autovacuum_vacuum_scale_factor = 0.2 # fraction of table size</description>
    </item>
    
    <item>
      <title>åˆ›å»ºåªè¯»ç”¨æˆ·</title>
      <link>https://zhangeamon.top/postgres/readonly/</link>
      <pubDate>Tue, 08 Sep 2020 09:28:59 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/readonly/</guid>
      <description>åˆ›å»ºåªè¯»ç”¨æˆ·readonly 1.åˆ›å»ºä¸€ä¸ªç”¨æˆ·åä¸ºreadonlyå¯†ç ä¸ºropassçš„ç”¨æˆ· CREATE USER readonly WITH ENCRYPTED PASSWORD &#39;ropass&#39;; 2.ç”¨æˆ·åªè¯»äº‹åŠ¡ alter user readonly set default_transaction_read_only=on; 3.æŠŠæ‰€æœ‰åº“çš„è¯­è¨€çš„USAGEæƒé™ç»™åˆ°readonly GRANT USAGE ON SCHEMA public to readonly; 4.æˆäºˆselectæƒé™(è¿™å¥è¦è¿›å…¥å…·ä½“æ•°æ®åº“æ“ä½œåœ¨å“ªä¸ªdbç¯å¢ƒæ‰§è¡Œå°±æˆäºˆé‚£ä¸ªdbçš„</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ OOM é¢„é˜²</title>
      <link>https://zhangeamon.top/postgres/oom/</link>
      <pubDate>Tue, 30 Jun 2020 09:26:42 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/oom/</guid>
      <description>é™ä½ä¸»è¿›ç¨‹è¢«OOM kill æ‰çš„é£é™© restart_after_crash é»˜è®¤å´©æºƒé‡å¯ postgres=# show restart_after_crash; restart_after_crash --------------------- on (1 row) vm.overcommit # vi /etc/sysctl.conf # 0 è¡¨ç¤ºå†…æ ¸å°†æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜ä¾›åº”ç”¨è¿›ç¨‹ä½¿ç”¨ï¼›å¦‚æœæœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜ï¼Œå†…å­˜ç”³è¯·å…è®¸ï¼›å¦åˆ™ï¼Œå†…å­˜ç”³è¯·å¤±è´¥ï¼Œå¹¶æŠŠé”™è¯¯è¿”å›ç»™åº”ç”¨è¿›ç¨‹ # 1 è¡¨ç¤ºå†…æ ¸å…è®¸åˆ†é…æ‰€æœ‰çš„ç‰©ç†å†…å­˜ï¼Œè€Œä¸ç®¡å½“å‰çš„å†…å­˜çŠ¶æ€å¦‚ä½• # 2 è¡¨ç¤ºå†…æ ¸å…è®¸åˆ†é…è¶…</description>
    </item>
    
    <item>
      <title>checkpoint æ£€æŸ¥ç‚¹</title>
      <link>https://zhangeamon.top/postgres/checkpoint/</link>
      <pubDate>Wed, 13 Mar 2019 15:57:25 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/checkpoint/</guid>
      <description>ä½œç”¨ ä¸€èˆ¬checkpointä¼šå°†æŸä¸ªæ—¶é—´ç‚¹ä¹‹å‰çš„è„æ•°æ®å…¨éƒ¨åˆ·æ–°åˆ°ç£ç›˜ï¼Œä»¥å®ç°æ•°æ®çš„ä¸€è‡´æ€§ä¸å®Œæ•´æ€§ã€‚å…¶ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ç¼©çŸ­å´©æºƒæ¢å¤æ—¶é—´ã€‚ æ•°æ®åº“é è°±çš„åŸå›  ä¸€æ¡DML å†™å…¥è¿‡ç¨‹ åœ¨å†™å…¥æ•°æ®çš„æ—¶ï¼Œå½“äº‹åŠ¡æäº¤åä¿®æ”¹ä¿¡æ¯é¡ºåºåŒæ­¥å†™å…¥walã€‚shared bufferä¸­ä¿¡æ¯å¹¶ä¸æ˜¯é©¬ä¸Šè½ç›˜ã€‚å¼‚æ­¥åŒæ­¥ç£ç›˜</description>
    </item>
    
    <item>
      <title>å’¨è¯¢é” adlock</title>
      <link>https://zhangeamon.top/postgres/adlock/</link>
      <pubDate>Thu, 07 Mar 2019 16:20:16 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/adlock/</guid>
      <description>https://github.com/digoal/blog/blob/master/201805/20180524_02.md è¡Œçº§é” select .. for update select .. for update skip locked select .. for share</description>
    </item>
    
    <item>
      <title>pgpoolii è¯»å†™åˆ†ç¦»</title>
      <link>https://zhangeamon.top/postgres/pgpool2/</link>
      <pubDate>Wed, 30 Jan 2019 15:43:25 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pgpool2/</guid>
      <description>https://www.pgpool.net/docs/pgpool-II-3.5.4/doc/tutorial-zh_cn.html#dist-def https://www.xiaomastack.com/2019/08/16/postgresqlé›†ç¾¤/</description>
    </item>
    
    <item>
      <title>é€»è¾‘å¤åˆ¶</title>
      <link>https://zhangeamon.top/postgres/logical-replication/</link>
      <pubDate>Wed, 30 Jan 2019 15:42:25 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/logical-replication/</guid>
      <description>é€»è¾‘å¤åˆ¶ Postgres 10 ç‰ˆæœ¬å¼€å§‹ï¼Œ åœ¨å†…æ ¸å±‚é¢æ”¯æŒåŸºäºREDOæµçš„é€»è¾‘å¤åˆ¶ã€‚ æ§åˆ¶ç²’åº¦ä¸ºè¡¨çº§åˆ« ç‰©ç†å¤åˆ¶ç›¸åŒéƒ½æ˜¯åŸºäºwal å¯æŒ‡å®šå¤šä¸ªä¸Šæ¸¸æ•°æ®æº ä¸‹æ¸¸æ•°æ®å¯è¯»å¯å†™ å¯ç”¨äºæ•°æ®æ±‡æ€»ï¼Œæ— åœæœæ•°æ®è¿ç§»,å¤§ç‰ˆæœ¬å‡çº§ç­‰ã€‚ åŸºæœ¬æ¦‚å¿µ å‘å¸ƒè€…ï¼ˆpublicationï¼‰ï¼Œ ä¸Šæ¸¸æ•°æ® è®¢é˜…è€… (subscrition)ï¼Œ ä¸‹æ¸¸æ•°æ® å¤</description>
    </item>
    
    <item>
      <title>PGä¸»ä»åˆ‡æ¢ pg_rewind</title>
      <link>https://zhangeamon.top/postgres/pg_rewind/</link>
      <pubDate>Wed, 30 Jan 2019 10:16:17 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_rewind/</guid>
      <description>pg_rewind requires that the target server either has the wal_log_hints option enabled in postgresql.conf or data checksums enabled when the cluster was initialized with initdb. Neither of these are currently on by default. full_page_writes must also be set to on, but is enabled by default. wal_log_hints ä½¿ç”¨åœºæ™¯ åœ¨æ•°æ®åº“ä¸»ä»ç»“æ„ä¸­ï¼Œä»å˜æˆä¸»æ˜“ã€‚ä½†æ˜¯ç”±ä¸»å˜ä¸ºä»å´éœ€è¦ä¸€ç•ªå‘¨æŠ˜ã€‚ å¦‚æœæ˜¯æ•°æ®é‡å°‘æ—¶é‡æ–°ä½¿ç”¨pg_backupæ‹‰ä¸€ä»½ä»å³å¯ï¼Œä½†æ˜¯å¦‚æœæ•°æ®é‡å¤§æ—¶ï¼Œè¿™ä¸ªè¿‡ç¨‹éå¸¸çš„è€—æ—¶è€—èƒ½ã€‚å¯¹çº¿ä¸Šä¸šåŠ¡ä¹Ÿä¼šæœ‰å½±</description>
    </item>
    
    <item>
      <title>PGé«˜å¯ç”¨Patroni</title>
      <link>https://zhangeamon.top/postgres/patroni/</link>
      <pubDate>Wed, 30 Jan 2019 10:14:55 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/patroni/</guid>
      <description>ç¯å¢ƒ æ“ä½œç³»ç»Ÿ Centos 7 patroni ç‰ˆæœ¬ 2.0.2 postgres ç‰ˆæœ¬ 13 å®ç°ç›®æ ‡ é«˜å¯ç”¨æ–¹æ¡ˆå¯¹æ¯” patroni ç»“æ„åˆ†æ patroni æ­å»ºæ–°é›†ç¾¤ patroni æ¥ç®¡ç°æœ‰é›†ç¾¤ patroni ç®¡ç†pgé…ç½® æ‰‹åŠ¨swithover è‡ªåŠ¨failover ç»´æŠ¤æ¨¡å¼ å¼¹æ€§æ‰©å®¹ï¼Œç¼©å®¹ å¯¹å¤–æä¾›ç»Ÿä¸€æœåŠ¡ RestFULLAPI å¤‡ä»½æ¢å¤ ç›‘æ§ æ—¥å¿— å‡çº§ é«˜å¯ç”¨æ–¹æ¡ˆå¯¹æ¯” pgçš„é«˜å¯ç”¨æ–¹æ¡ˆéƒ½æ˜¯åŸºäºæµå¤åˆ¶æ¥å®ç° PAF pacemaker + corosyns repmgr repmgr æ‰‹åŠ¨æµå¤åˆ¶ç®¡</description>
    </item>
    
    <item>
      <title>pg_pathman åˆ†åŒºè¡¨</title>
      <link>https://zhangeamon.top/postgres/pg_pathman/</link>
      <pubDate>Thu, 24 Jan 2019 10:56:06 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_pathman/</guid>
      <description>ä»‹ç» åˆ†åŒºè¡¨çš„è¯‰æ±‚åœ¨ç°å®çš„ç”Ÿæˆä¸­çš„æ„ä¹‰ä¸å¿…å¤šè¯´ï¼Œpgä»¥å‰çš„å®ç°æ–¹å¼å¤šé‡‡ç”¨è§¦å‘å™¨ï¼Œruleså®ç°ã€‚æ•°æ®é‡ä¸Šæ¥æ—¶æ€§èƒ½æ˜æ˜¾ä¸å°½å¦‚æ„ã€‚ è™½ç„¶pg10 ï¼Œ11 ç‰ˆæœ¬åœ¨åˆ†åŒºè¡¨çš„ç‰¹æ€§ä¸Šä¸æ–­å‘åŠ›ã€‚ä½†æ˜¯æ€§èƒ½å•¥è¿˜æ˜¯ä¸å¤Ÿç»™åŠ›ã€‚ pg_pathman åˆ†åŒºè¡¨åŠŸèƒ½åœ¨ç›®å‰çš„pgç‰ˆæœ¬10.6 ä¸­ä¼˜åŠ¿è¿˜æ˜¯éå¸¸æ˜æ˜¾çš„ã€‚ åœ¨æœŸå¾…pgè‡ªèº«åˆ†åŒºè¡¨ç‰¹æ€§çš„</description>
    </item>
    
    <item>
      <title>å¼•èµ·ç´¢å¼•å¤±æ•ˆ</title>
      <link>https://zhangeamon.top/postgres/index-invalid/</link>
      <pubDate>Thu, 20 Dec 2018 16:34:22 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/index-invalid/</guid>
      <description>ç®€ä»‹ ç´¢å¼•çš„ä½œç”¨ï¼ŒåŠ é€Ÿæ£€ç´¢ï¼Œæ’åºï¼Œåˆ†ç»„ã€‚ ä¼˜ç‚¹ï¼š æ£€ç´¢ ç¼ºç‚¹ï¼š æ–°å¢ï¼Œæ›´æ–°æ—¶éœ€è¦ç»´æŠ¤ç´¢å¼•ï¼Œå ç£ç›˜ç©ºé—´ï¼Œåˆ›å»ºæ—¶é”è¡¨ã€‚ ç»´æŠ¤ï¼š æ ¹æ®ç»Ÿè®¡è¡¨å‘ç”Ÿå…¨è¡¨æ‰«ææ¬¡æ•°ï¼Œç´¢å¼•ä½¿ç”¨æ¬¡æ•°ã€‚åˆç†æ·»åŠ åˆ é™¤ç´¢å¼•ã€‚ ç´¢å¼•å¤±æ•ˆçš„åœºæ™¯ å¦‚æœwhereè¿‡æ»¤æ¡ä»¶è®¾ç½®ä¸åˆç†ï¼Œå³ä½¿ç´¢å¼•å­˜åœ¨ï¼Œä¸”whereè¿‡æ»¤æ¡ä»¶ä¸­åŒ…å«ç´¢å¼•åˆ—ï¼Œä¹Ÿä¼šå¯¼è‡´å…¨è¡¨æ‰«</description>
    </item>
    
    <item>
      <title>DBA æ—¥å¸¸</title>
      <link>https://zhangeamon.top/postgres/dba/</link>
      <pubDate>Wed, 19 Dec 2018 11:33:43 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/dba/</guid>
      <description>å¤‡ä»½ æ¢å¤ æ—¶æ—¶çƒ­å¤‡ å®šæœŸå†·å¤‡ å‡çº§ æ¯å¹´å¤§ç‰ˆæœ¬å°ç‰ˆæœ¬å‡çº§ï¼Œæ–°ç‰¹æ€§è°ƒç ”ï¼Œæ€§èƒ½æµ‹è¯•ï¼Œç¨³å®šæ€§ã€‚ å¯ç”¨å½“å‰æœ€æ–°çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚ HA æ‰‹åŠ¨ è‡ªåŠ¨ è¯»å†™åˆ†ç¦» sharding å¤šå‰¯æœ¬ å®‰å…¨ æƒé™ç®¡ç† èµ„æºéš”ç¦» å®¡è®¡ ddl æ…¢sql é”é•¿æ—¶é—´å ç”¨ å·¡æ£€ å®šæœŸå·¡æ£€ awr æŠ¥å‘Š ç›‘æ§ ç³»ç»Ÿ æ•°æ®åº“ è¯Šæ–­ ä¼˜åŒ– èƒŒæ™¯ åº”ç”¨ç¨‹åºçš„é‡è›®ç”Ÿé•¿ï¼Œç”±äº§å“ä¸ºé©±åŠ¨çš„å¼€å‘ï¼Œä¸€åˆ‡ä»¥å¿«é€Ÿä¸Šçº¿ä¸ºç›®</description>
    </item>
    
    <item>
      <title>Postgres ç›‘æ§å¸¸ç”¨å·¥å…·</title>
      <link>https://zhangeamon.top/postgres/monitor/</link>
      <pubDate>Thu, 06 Dec 2018 16:21:08 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/monitor/</guid>
      <description>å„ç§ç›‘æ§æ–¹å¼ zabbix Monitor PostgreSQL with Zabbix postgres_exporter A PostgresSQL metric exporter for Prometheus pgwatch2 PostgreSQL metrics monitor/dashboard pgmetrics Collect and display information and stats from a running PostgreSQL server pgdash (æ”¶è´¹) pganalyze PostgreSQL Performance Monitoring å‚è€ƒè‡ªå·±å®ç° çŠ¶æ€æŸ¥çœ‹ pgcenter pgcenter top pgcenter: 2018-12-20 11:10:25, load average: 0.94, 0.84, 0.86 state [ok]: ::1:5432 postgres@postgres (ver: 10.6, up 8 days 19:57:54, recovery: f) %cpu: 15.0 us, 3.7 sy, 0.0 ni, 75.3 id, 5.7 wa, 0.0 hi, 0.2 si, 0.0 st activity: 5/1000 conns, 0/0 prepared, 2 idle, 0 idle_xact, 3 active, 0 waiting, 0 others MiB mem: 7821 total, 162 free, 424 used, 7235 buff/cached autovacuum: 0/3 workers/max, 0 manual, 0 wraparound, 00:00:00 vac_maxtime MiB swap: 1023 total, 903 free, 120 used, 0/0 dirty/writeback statements: 1888 stmt/s,</description>
    </item>
    
    <item>
      <title>vacuum åƒåœ¾å›æ”¶å™¨</title>
      <link>https://zhangeamon.top/postgres/vacuum/</link>
      <pubDate>Wed, 05 Dec 2018 16:48:00 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/vacuum/</guid>
      <description>ä»‹ç» æ•°æ®åº“æ€»æ˜¯ä¸æ–­åœ°åœ¨æ‰§è¡Œåˆ é™¤ï¼Œæ›´æ–°ç­‰æ“ä½œã€‚è‰¯å¥½çš„ç©ºé—´ç®¡ç†éå¸¸é‡è¦ï¼Œèƒ½å¤Ÿå¯¹æ€§èƒ½å¸¦æ¥å¤§å¹…æé«˜ã€‚åœ¨postgresqlä¸­ç”¨äºç»´æŠ¤æ•°æ®åº“ç£ç›˜ç©ºé—´çš„å·¥å…·æ˜¯VACUUMï¼Œå…¶é‡è¦çš„ä½œç”¨æ˜¯åˆ é™¤é‚£äº›å·²ç»æ ‡ç¤ºä¸ºåˆ é™¤çš„æ•°æ®å¹¶é‡Šæ”¾ç©ºé—´ã€‚ postgresqlä¸­æ‰§è¡Œdelete,updateæ“ä½œåï¼Œè¡¨ä¸­çš„</description>
    </item>
    
    <item>
      <title>Explain æ‰§è¡Œè®¡åˆ’</title>
      <link>https://zhangeamon.top/postgres/explain/</link>
      <pubDate>Wed, 05 Dec 2018 15:27:30 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/explain/</guid>
      <description>æ–‡æ³• EXPLAIN [ ( option [, ...] ) ] statement EXPLAIN [ ANALYZE ] [ VERBOSE ] statement è¿™é‡Œ optionå¯ä»¥æ˜¯ï¼š ANALYZE [ boolean ] VERBOSE [ boolean ] COSTS [ boolean ] BUFFERS [ boolean ] TIMING [ boolean ] SUMMARY [ boolean ] FORMAT { TEXT | XML | JSON | YAML } æ³¨æ„äº‹é¡¹ è®°ä½å½“ä½¿ç”¨äº†ANALYZEé€‰é¡¹æ—¶è¯­å¥ä¼šè¢«å®é™…æ‰§è¡Œ. å¦‚æ‰§è¡Œdml æ—¶å°†å¯¹æ•°æ®åº“è¿›è¡Œå®é™…çš„æ“ä½œã€‚ é¿å…æ±¡æŸ“æ•°æ®çš„æ–¹å¼ BEGIN; EXPLAIN ANALYZE ...; ROLLBACK; ä¸€ä¸ªä¾‹å­ postgres=# explain analyze select * from tbl; QUERY</description>
    </item>
    
    <item>
      <title>pg_stat_statements æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯</title>
      <link>https://zhangeamon.top/postgres/pg_stat_statements/</link>
      <pubDate>Thu, 29 Nov 2018 11:08:27 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_stat_statements/</guid>
      <description>pg_stat_statements æ‰©å±• å®‰è£… yum install postgresql10-contrib.x86_64 ä¿®æ”¹é…ç½®å‚æ•° vi $PGDATA/postgresql.conf shared_preload_libraries=&#39;pg_stat_statements&#39; # åŠ è½½æ¨¡å— éœ€è¦é‡å¯ , è¿‘æœŸæµ‹è¯•ä¸éœ€è¦æ·»åŠ ä¹Ÿå¯ä»¥ã€‚è‡ªå¸¦æ‰©å±• track_io_timing = on # è·Ÿè¸ªIOè€—æ—¶ (å¯é€‰) track_activity_query_size = 2048 # è®¾ç½®å•æ¡SQLçš„æœ€é•¿é•¿åº¦ï¼Œè¶…è¿‡è¢«æˆªæ–­æ˜¾ç¤ºï¼ˆå¯é€‰) pg_stat_statements.max = 10000 #åœ¨pg_stat_statementsä¸­æœ€å¤šä¿ç•™å¤šå°‘æ¡ç»Ÿè®¡ä¿¡æ¯ï¼Œé€šè¿‡LRUç®—æ³•ï¼Œè¦†ç›–è€çš„è®°å½•ã€‚ pg_stat_statements.track = all</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å‚æ•°</title>
      <link>https://zhangeamon.top/postgres/params/</link>
      <pubDate>Tue, 27 Nov 2018 09:57:27 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/params/</guid>
      <description>æ€§èƒ½å‚æ•° pgtune pgconfig cybertec æ—¥å¿—å‚æ•° æ›´å¤šå‚æ•°è¯¦è§£ ç®¡ç† listen_addresses = &amp;quot;*&amp;quot; # è¿æ¥è®¿é—®æ§åˆ¶ï¼Œå“ªäº›ipå¯ä»¥è®¿é—®ï¼Œ * å…¨éƒ¨ã€‚ ç»“åˆpg_hba.conf , iptablesè®¾ç½®ã€‚ superuser_reserved_connections = 3 # é¢„ç•™ç»™è¶…çº§ç®¡ç†å‘˜çš„è¿æ¥æ•°ã€‚ port = 5432 # é»˜è®¤è®¿é—®ç«¯å£ wal_keep_segments = 1024 # wal æ—¥å¿—ä¿å­˜æ•°é‡ walæ—¥å¿— wal_log_hints = on full_page_writes = on æˆæœ¬å› å­ # - Planner Cost Constants - #seq_page_cost = 1.0 # measured on an arbitrary scale é¡ºåºæ‰«æ</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å¤‡ä»½å’Œæ¢å¤</title>
      <link>https://zhangeamon.top/postgres/backup_restore/</link>
      <pubDate>Tue, 30 Oct 2018 10:18:57 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/backup_restore/</guid>
      <description>å¤‡ä»½æ¢å¤å‘½ä»¤ å¤‡ä»½ï¼špg_dump -U postgres -v -F c -Z 4 -f ***.backup dbname 9å‹ç¼©ç‡æœ€ç‹  æ¢å¤ï¼špg_restore -U postgres -v -j 8 -d dbname ***.backup 8æ˜¯é‡‡ç”¨8ä¸ªçº¿ç¨‹ å¤‡ä»½è¡¨ï¼špg_dump -U postgres -t tablename dbname &amp;gt; 33.sql æ¢å¤è¡¨ï¼špsql -U postgres -d dbname &amp;lt; 33.sql åªå¤‡ä»½è¡¨ç»“æ„ pg_dump -U postgres -s -t tablename dbname &amp;gt; 33.sql åªå¤‡ä»½æ•°æ® pg_dump -U postgres -a -t tablename dbname &amp;gt; 33.sql copy æ‹·è´æ•°æ® æ•°æ®æ‹·è´åˆ°æœ¬åœ°ï¼š psql -U postgres -d databasename</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å¤‡ä»½å’Œæ¢å¤wal-g åº”ç”¨</title>
      <link>https://zhangeamon.top/postgres/wal-g/</link>
      <pubDate>Tue, 30 Oct 2018 10:18:57 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/wal-g/</guid>
      <description>å­˜å‚¨æœåŠ¡ minio è®¾ç½®ç”¨æˆ·åå’Œå¯†ç  docker run -d -p 9000:9000 -e MINIO_ACCESS_KEY=xxxxx(changeme) -e MINIO_SECRET_KEY=kkkkk(changeme) -v /data/minio/:/data minio/minio server /data åˆ›å»º bucket mc mb local/buecket003 wal-g ä¸‹è½½ wget https://github.com/wal-g/wal-g/releases/download/v0.2.9/wal-g.linux-amd64.tar.gz tar -zxvf wal-g.linux-amd64.tar.gz è®¾ç½®ç¯å¢ƒå˜é‡ minio cat wal-g.env export PGDATA=/var/lib/pgsql/10/data/ export WALG_S3_PREFIX=s3://bucket003/ export PGPORT=5432 export PGUSER=postgres export AWS_SECRET_ACCESS_KEY=xxxxx(changeme) export AWS_REGION=us-east-1 export AWS_ACCESS_KEY_ID=kkkkk(changeme) export AWS_ENDPOINT=http://localhost:9000 export AWS_S3_FORCE_PATH_STYLE=true swift export PGDATA= export WALG_SWIFT_PREFIX=swift://buckt003/ export PGPORT= export PGUSER= export OS_USERNAME= export OS_PASSWORD= export OS_AUTH_URL=http://ip:port/auth/v1.0 å…¨å¤‡ä»½ source mydir/wal-g.env &amp;amp;&amp;amp; wal-g backup-push $PGDATA wal å¤‡ä»½ wal_level = archive archive_mode = on ## ä»åº“ always archive_command = &#39;source mydir/wal-g.env &amp;amp;&amp;amp; wal-g wal-push %p&#39; archive_timeout = 60 æ¢å¤æ•°æ® æŸ¥çœ‹æ‰€æœ‰å…¨å¤‡ä»½ wal-g backup-list name last_modified wal_segment_backup_start base_000000020000001E000000CB 2019-11-07T01:34:08Z 000000020000001E000000CB base_000000020000001E000000CD 2019-11-07T01:37:03Z 000000020000001E000000CD base_000000020000001E000000CF 2019-11-07T02:23:34Z</description>
    </item>
    
    <item>
      <title>ä¸»ä»æµå¤åˆ¶</title>
      <link>https://zhangeamon.top/postgres/replication01/</link>
      <pubDate>Wed, 17 Oct 2018 14:55:38 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/replication01/</guid>
      <description>å†å²æ¼”å˜ replication ä¸»åº“é…ç½® æ ¹æ®å®é™…æƒ…å†µåˆ†é…æµå¤åˆ¶æƒé™ vi pg_hba.conf host replication all 10.2.0.0/0 trust vi postgresql.conf max_wal_senders = 10 wal_level = logical # minimal, replica, or logical hot_standby = on # æ­£å¸¸åœ¨ä»åº“é…ç½®ï¼Œå¦‚æœåœ¨ä¸»åº“é…ç½®å®Œæ¯•ï¼Œå› ä¸ºä»åº“å¤åˆ¶ä¸»åº“é…ç½®ä¸éœ€è¦å†ä¿®æ”¹ä»åº“é…ç½®ã€‚ wal_log_hints = on ä»åº“é…ç½® æ•°æ®åº“å®‰è£… ä»ä¸»åº“å¤åˆ¶æ•°æ® pg_basebackup -h 10.2.0.14 -U postgres -F p -P -R -D /var/lib/pgsql/10/data/ --checkpoint=fast -l postgresback20181219 pg_basebackupæ”¯æŒä¸¤ç§å…¨é‡å¤‡ä»½çš„</description>
    </item>
    
  </channel>
</rss>
