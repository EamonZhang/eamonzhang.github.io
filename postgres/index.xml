<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Postgres on Let&#39;s go ğŸŒ ğŸŒ ğŸŒ</title>
    <link>https://zhangeamon.top/postgres/</link>
    <description>Recent content in Postgres on Let&#39;s go ğŸŒ ğŸŒ ğŸŒ</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <lastBuildDate>Mon, 08 Aug 2022 14:58:08 +0800</lastBuildDate><atom:link href="https://zhangeamon.top/postgres/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>LSN å’Œ walæ—¥å¿—æ–‡ä»¶åå¯¹åº”å…³ç³»</title>
      <link>https://zhangeamon.top/postgres/wal_lsn/</link>
      <pubDate>Mon, 08 Aug 2022 14:58:08 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/wal_lsn/</guid>
      <description>ä¾‹å­ select pg_current_wal_lsn(),pg_walfile_name(pg_current_wal_lsn()),pg_walfile_name_offset(pg_current_wal_lsn()); pg_current_wal_lsn | pg_walfile_name | pg_walfile_name_offset --------------------+--------------------------+------------------------------------ 2478/BB36EC90 | 0000000300002478000000BB | (0000000300002478000000BB,3599504) (1 row) select x&#39;36EC90&#39;::int ; int4 --------- 3599504 (1 row) è¯´æ˜ æ–¹æ³• pg_current_wal_lsn()ï¼šè·å¾—å½“å‰walæ—¥å¿—å†™å…¥ä½ç½®ã€‚ pg_walfile_name():è½¬æ¢walæ—¥å¿—ä½ç½®ä¸ºæ–‡ä»¶åã€‚ pg_walfile_name_offset():è¿”å›è½¬æ¢åçš„walæ—¥å¿—æ–‡ä»¶åå’Œåç§»é‡ã€‚</description>
    </item>
    
    <item>
      <title>upset ç”¨æ³•</title>
      <link>https://zhangeamon.top/postgres/upset/</link>
      <pubDate>Fri, 29 Jul 2022 08:47:34 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/upset/</guid>
      <description>åˆ›å»ºè¡¨ DROP TABLE IF EXISTS &amp;quot;goods&amp;quot;; CREATE TABLE &amp;quot;goods&amp;quot; ( &amp;quot;store_cd&amp;quot; int4 NOT NULL, &amp;quot;good_cd&amp;quot; varchar(50) COLLATE &amp;quot;pg_catalog&amp;quot;.&amp;quot;default&amp;quot; NOT NULL, &amp;quot;name&amp;quot; varchar(255) COLLATE &amp;quot;pg_catalog&amp;quot;.&amp;quot;default&amp;quot; ); INSERT INTO &amp;quot;goods&amp;quot; VALUES (101, &#39;1&#39;, &#39;å¼ ä¸‰&#39;); INSERT INTO &amp;quot;goods&amp;quot; VALUES (102, &#39;2&#39;, &#39;æå››&#39;); INSERT INTO &amp;quot;goods&amp;quot; VALUES (103, &#39;3&#39;, &#39;ç‹äº”&#39;); ALTER TABLE &amp;quot;goods&amp;quot; ADD CONSTRAINT &amp;quot;pr_cd_key&amp;quot; PRIMARY KEY (&amp;quot;store_cd&amp;quot;, &amp;quot;good_cd&amp;quot;); æ•°æ®å­˜åœ¨åˆ™æ›´æ–°æ•°æ®ï¼Œä¸å­˜åœ¨åˆ™æ’å…¥æ•°æ® --- INSERT INTO GOODS VALUES ( 104, &#39;4&#39;, &#39;èµµå…­&#39; ) ON CONFLICT ON CONSTRAINT pr_key_cd DO UPDATE SET NAME = &#39;æ›´æ–°&#39; WHERE GOODS.STORE_CD = &#39;104&#39; AND GOODS.GOOD_CD = &#39;4&#39; ---- pr_key_cdä¸ºå¿…é¡»ä¸º</description>
    </item>
    
    <item>
      <title>åˆ©ç”¨debezium å®ç°æ•°æ®å˜æ›´æ•è·</title>
      <link>https://zhangeamon.top/postgres/debezium/</link>
      <pubDate>Wed, 27 Jul 2022 10:37:46 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/debezium/</guid>
      <description>æ•´ä¸ªå®ç°ä»¥åŠŸèƒ½æ¼”ç¤ºä¸ºç›®æ ‡ï¼Œä¾¿äºæµç¨‹çš„æ¢³ç†å’Œç†è§£ã€‚ä¸é€‚åˆæ­£å¼ç”Ÿæˆç¯å¢ƒä½¿ç”¨ã€‚ debeziumçš„å‡ ç§ä½¿ç”¨æ–¹å¼ å•ç‹¬éƒ¨ç½² ä¸‹æ¸¸æ•°æ®ä¼ è¾“åˆ°cloudï¼Œå®˜æ–¹ç›®å‰ä¸æ¨è ä¸kafkaè”åˆä½¿ç”¨ ä¸‹æ¸¸æ•°æ®ä¼ è¾“åˆ°kafka åµŒå…¥å¼ ä¾‹å¦‚Flinkä½¿ç”¨çš„debeziumä½œä¸ºæ•°æ®çš„source connetoræ¨¡å—ä½¿</description>
    </item>
    
    <item>
      <title>åˆ©ç”¨hllæ•°æ®ç±»å‹è¿›è¡Œæ•°æ®ç»Ÿè®¡</title>
      <link>https://zhangeamon.top/postgres/hll/</link>
      <pubDate>Thu, 14 Jul 2022 15:44:53 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/hll/</guid>
      <description>HyperLogLog ä½¿ç”¨åœºæ™¯ åœ¨åº”ç”¨ä¸­ç»Ÿè®¡å»é‡åçš„ä¸ªæ•°ï¼Œä¼ ç»Ÿçš„æ–¹æ³•é€šå¸¸æ˜¯è¿™ä¹ˆæ“ä½œ count(distict(xxx))ã€‚ å¦‚æœæ•°æ®é‡å˜å¤§ï¼Œæˆ–ç»Ÿè®¡é¢‘ç¹ï¼Œæ€§èƒ½ä¼šè¶Šæ¥è¶Šå·®ã€‚ å¯ä»¥è€ƒè™‘ä¸€ä¸ªè¿‘ä¼¼ç»Ÿè®¡è®¡ç®—æ–¹æ³•hll create extension hll; HyperLogLog æ˜¯ä¸€ç§ç®—æ³•, å¯ä»¥ç”¨æ¥ä¼°ç®—æ•°æ®é›†çš„åŸºæ•°. åŸºæ•°æ˜¯æŒ‡ä¸€ä¸ªé›†åˆä¸­ä¸åŒå€¼çš„æ•°ç›®, ç­‰åŒäº COUNT(DISTINCT field) è¿”å›å€¼. å¯¹äºè¶…</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“é«˜å¯ç”¨pgautofailover</title>
      <link>https://zhangeamon.top/postgres/pgautofailover/</link>
      <pubDate>Mon, 11 Jul 2022 15:15:51 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pgautofailover/</guid>
      <description>pg_auto_failover å®è·µ ä¸€ä¸ªç®€å•çš„æ¶æ„ citusåŒæºpostgresé«˜å¯ç”¨æ–¹æ¡ˆ è§’è‰²: ä¸»èŠ‚ç‚¹ (master) å¤åˆ¶èŠ‚ç‚¹ (slave) ç›‘æ§èŠ‚ç‚¹ (monitor) é›†ç¾¤æ­å»º ç¯å¢ƒè¯´æ˜ è½¯ä»¶ç‰ˆæœ¬ postgresql 14.4 pg_auto_failover 1.6.4 centos 7 ç½‘ç»œç¯å¢ƒ IP è½¯ä»¶ 10.10.2.11 monitor 10.10.2.12 master 10.10.2.13 replication ä»é›¶å¼€å§‹å»ºè®¾ â€‹ æ²¡æœ‰ä»»ä½•å†å²åŒ…è¢±ï¼ŒåŒ…æ‹¬æ•°æ®åº“è‡ªèº«çš„æ­å»º â€‹ æ‰‹åŠ¨å®‰è£… â€‹ åœ¨æ‰€æœ‰çš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œ -- æ•°æ®åº“å®‰è£… sudo yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm sudo yum install -y postgresql14-server # install pg_auto_failover curl https://install.citusdata.com/community/rpm.sh</description>
    </item>
    
    <item>
      <title>pg_rewrite</title>
      <link>https://zhangeamon.top/postgres/pg_rewrite/</link>
      <pubDate>Fri, 01 Jul 2022 17:06:25 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_rewrite/</guid>
      <description>åœ¨çº¿åˆ†åŒºè¡¨ https://github.com/cybertec-postgresql/pg_rewrite ä½¿ç”¨æµ‹è¯• PostgreSQL server version 13 or later is required.</description>
    </item>
    
    <item>
      <title>é€»è¾‘å¤åˆ¶å®ç°æ•°æ®è¿ç§»</title>
      <link>https://zhangeamon.top/postgres/dts/</link>
      <pubDate>Fri, 01 Jul 2022 16:36:52 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/dts/</guid>
      <description>DTS æ•°æ®è¿ç§»æœåŠ¡ å®ç°ç›®æ ‡ â€‹ å¹³æ»‘å°†ç°æœ‰åœ¨çº¿ä¸šåŠ¡æ•°æ®åº“æ•°æ®è¿ç§»åˆ°æ–°æ•°æ®åº“ä¸­ã€‚ â€‹ å¦‚æ•°æ®åº“å¤§ç‰ˆæœ¬å‡çº§ã€åŸpgæ•°æ®åº“è¿ç§»åˆ°citusé›†ç¾¤ã€ å¤šæ•°æ®æºæ±‡æ€»ç­‰ä¸šåŠ¡åœºæ™¯ã€‚ è¿ç§»å‰åŸåº“æ£€æŸ¥ é…ç½®æ£€æŸ¥ -- æºç«¯ wal_level = logical max_replication_slots = å¤§äº1 max_wal_senders = max_worker_processes -- ç›®æ ‡ç«¯ max_replication_slotsï¼Œå¤§äºç­‰äºè¯¥å®ä¾‹æ€»å…±éœ€è¦åˆ›å»ºçš„</description>
    </item>
    
    <item>
      <title>pg_buffercache</title>
      <link>https://zhangeamon.top/postgres/pg_buffercache/</link>
      <pubDate>Fri, 01 Jul 2022 09:54:49 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_buffercache/</guid>
      <description>é€šè¿‡æ’ä»¶æŸ¥çœ‹PGæ•°æ®ç¼“å­˜ create extension pg_buffercache; æŸ¥çœ‹å½“å‰databaseç¼“å­˜ä½¿ç”¨æƒ…å†µ select c.relname,relname,pg_size_pretty(pg_table_size(c.oid)),pg_size_pretty(count(*) * 8192) as buffered, round(100.0*count(*)/(select setting FROM pg_settings where name = &#39;shared_buffers&#39;)::integer,1) as buffer_percent, round(100.0 * count(*) * 8192/pg_table_size(c.oid)) as percent_of_table from pg_class c inner join pg_buffercache b on b.relfilenode = c.relfilenode inner join pg_database d on (b.reldatabase = d.oid and d.datname = current_database()) group by c.oid ,c.relname order by 3 desc limit 10;</description>
    </item>
    
    <item>
      <title>citus11 ç®¡ç†æ‰‹å†Œ</title>
      <link>https://zhangeamon.top/postgres/citus11/</link>
      <pubDate>Wed, 29 Jun 2022 17:29:11 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/citus11/</guid>
      <description>ç¯å¢ƒä»‹ç» ç‰ˆæœ¬ä¿¡æ¯ centos7 postgres 14.4 citus 110-2 å®‰è£…æ­¥éª¤ å®‰è£… ç•¥ é…ç½® sudo pg_conftool 14 main set wal_level logical sudo pg_conftool 14 main set listen_addresses &#39;*&#39; sudo pg_conftool 14 main set shared_preload_libraries citus sudo vi /etc/postgresql/14/main/pg_hba.conf åˆ›å»ºæ•°æ®åº“å…å¯†ç ç™»å½• -- Edit .pgpass in the postgres userâ€™s home directory, hostname:port:database:username:password èŠ‚ç‚¹ä¿¡æ¯ nodenanme IP role master01 10.10.20.11 coordinator worker01 10.10.2.12 worker worker02 10.10.2.14 worker æ­å»ºé›†ç¾¤ åˆ›å»ºdatabase&amp;amp;extension åœ¨æ¯ä¸ªworkerèŠ‚ç‚¹ä¸Šæ‰§è¡Œ CREATE DATABASE newbie; \c newbie CREATE EXTENSION citus; åœ¨ma</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å…å¯†ç ç™»é™†</title>
      <link>https://zhangeamon.top/postgres/login_nopasswd/</link>
      <pubDate>Wed, 23 Mar 2022 14:41:44 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/login_nopasswd/</guid>
      <description>å…å¯†ç™»é™† ä»¥ä¸‹å‡ ç§PGé…ç½®å…å¯†çš„æ–¹æ³•ã€‚ æ–¹æ³•ä¸€ï¼šè®¾ç½®pg_hab.conf è®¤è¯æ–¹å¼ä¸ºtrust #Type database user address method host all postgres 127.0.0.1/32 trust è¯¥æ–¹å¼æœ€ä¸å®‰å…¨ï¼Œå¯¼è‡´é€šè¿‡æŒ‡å®šIPè¿æ¥æ•°æ®åº“çš„è¿æ¥éƒ½å¯ä»¥ä»»æ„ç™»å½•æ•°æ®ï¼Œæ¯«æ— å®‰å…¨ä¿éšœã€‚ç¦æ­¢åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚ æ–¹æ³•äºŒï¼šè®¾ç½®PGç¯å¢ƒå˜é‡PGPASSWORD PGPASSWORDæ˜¯P</description>
    </item>
    
    <item>
      <title>vacuum é™æµ</title>
      <link>https://zhangeamon.top/postgres/vacuum_limit/</link>
      <pubDate>Fri, 11 Feb 2022 13:51:50 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/vacuum_limit/</guid>
      <description>é™æµç›®çš„ æ¸…ç†æ˜¯åœ¨åå°è¿è¡Œçš„ç»´æŠ¤ä»»åŠ¡ï¼Œå¯¹ç”¨æˆ·æŸ¥è¯¢çš„å½±å“æœ€å°ã€‚ä¸åº”è¯¥æ¶ˆè€—å¤ªå¤šçš„èµ„æº(CPUå’Œç£ç›˜I/O)ã€‚ æ¸…ç†æˆæœ¬è®¡ç®— æ¸…ç†è¿‡ç¨‹ç›¸å½“ç®€å•ï¼Œå®ƒä»æ•°æ®æ–‡ä»¶ä¸­è¯»å–é¡µé¢(8kBçš„æ•°æ®å—)ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦éœ€è¦æ¸…ç†ã€‚å¦‚æœæ²¡æœ‰dead tuplesï¼Œé¡µé¢å°†è¢«ç®€å•åœ°ä¸¢å¼ƒï¼Œè€Œä¸è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚å¦åˆ™ï¼Œå®ƒå°†è¢«æ¸…ç†(</description>
    </item>
    
    <item>
      <title>æŸ¥çœ‹æ•°æ®ä¿¡æ¯å¸¸ç”¨sqlæ•´ç†</title>
      <link>https://zhangeamon.top/postgres/monitor-sql/</link>
      <pubDate>Thu, 10 Feb 2022 10:21:07 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/monitor-sql/</guid>
      <description>åº“å†…å­˜å‘½ä¸­ç‡ SELECT &#39;index hit rate&#39; AS name, (sum(idx_blks_hit)) / nullif(sum(idx_blks_hit + idx_blks_read),0) AS ratio FROM pg_statio_user_indexes UNION ALL SELECT &#39;table hit rate&#39; AS name, sum(heap_blks_hit) / nullif(sum(heap_blks_hit) + sum(heap_blks_read),0) AS ratio FROM pg_statio_user_tables; è¡¨å†…å­˜å‘½ä¸­ç‡ SELECT relname AS relation, heap_blks_read AS heap_read, heap_blks_hit AS heap_hit, ((heap_blks_hit*100) / NULLIF((heap_blks_hit + heap_blks_read), 0)) AS ratio FROM pg_statio_user_tables order by ratio; è¯»IOå†…å­˜å æ¯” ç£ç›˜ä¸­è¯»å–å’Œåœ¨å†…å­˜ä¸­ç›´æ¥è¯»å–ä¹‹é—´çš„æ•°å­—å’Œæ¯” SELECT relname AS &amp;quot;relation&amp;quot;, heap_blks_read AS heap_read, heap_blks_hit AS heap_hit, ( (heap_blks_hit*100) / NULLIF((heap_blks_hit + heap_blks_read), 0)) AS ratioFROM pg_statio_user_tables; è¡¨ä¸­ç´¢å¼•å‘½ä¸­ç‡ SELECT relname, CASE idx_scan WHEN 0 THEN NULL ELSE round(100.0 * idx_scan / (seq_scan + idx_scan), 5) END</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å®æ—¶è¿è¡Œä¿¡æ¯æŸ¥çœ‹</title>
      <link>https://zhangeamon.top/postgres/pg_activity/</link>
      <pubDate>Wed, 12 Jan 2022 15:47:07 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_activity/</guid>
      <description>ä»‹ç» ç±»ä¼¼Linux top å‘½ä»¤ æŸ¥çœ‹æ•°æ®å®æ—¶è¿è¡Œæƒ…å†µ https://github.com/dalibo/pg_activity å®‰è£… æµ‹è¯•ç¯å¢ƒcentos7 postgresql10 æŸ¥çœ‹å·²å®‰è£…çš„PGç‰ˆæœ¬ å¦‚æœæœ‰9.2 ç‰ˆæœ¬ï¼Œæ¸…ç†,å¦‚æœæ²¡æœ‰postgresql10-devel éœ€è¦å®‰è£… yum list installed | grep postgres è®¾ç½®ç¯å¢ƒå˜é‡ export PG_HOME=/usr/pgsql-10 export PATH=$PATH:$PG_HOME/bin/ å®‰è£…pg_activity python3 -m pip install pg_activity psycopg2-binary ä½¿ç”¨ ä¸psql è¿æ¥æ–¹å¼ç›¸åŒ pg_activity -U xxx -p xxx æ›´å¤š</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“çš„jsonç±»å‹</title>
      <link>https://zhangeamon.top/postgres/pg_json/</link>
      <pubDate>Mon, 20 Dec 2021 10:51:16 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_json/</guid>
      <description>json ä¸ jsonb json ä¿æŒåŸå§‹æ ¼å¼ï¼Œ jsonbæ˜¯è§£æè¾“å…¥åä¿å­˜çš„äºŒè¿›åˆ¶ï¼Œåœ¨è§£ææ—¶ä¼šè¿‡æ»¤æ‰ä¸å¿…è¦çš„ç©ºæ ¼å’Œé‡å¤çš„å¥ã€‚ SELECT &#39;{&amp;quot;name&amp;quot;: &amp;quot;zhangsan&amp;quot;, &amp;quot;age&amp;quot;: 17, &amp;quot;sex&amp;quot;:&amp;quot;m&amp;quot;,&amp;quot;age&amp;quot;:17.5}&#39;::json; json ------------------------------------------------------------ {&amp;quot;name&amp;quot;: &amp;quot;zhangsan&amp;quot;, &amp;quot;age&amp;quot;: 17, &amp;quot;sex&amp;quot;:&amp;quot;m&amp;quot;,&amp;quot;age&amp;quot;:17.5} SELECT &#39;{&amp;quot;name&amp;quot;: &amp;quot;zhangsan&amp;quot;, &amp;quot;age&amp;quot;: 17, &amp;quot;sex&amp;quot;:&amp;quot;m&amp;quot;,&amp;quot;age&amp;quot;:17.5}&#39;::jsonb; jsonb ----------------------------------------------- {&amp;quot;age&amp;quot;: 17.5, &amp;quot;sex&amp;quot;: &amp;quot;m&amp;quot;, &amp;quot;name&amp;quot;: &amp;quot;zhangsan&amp;quot;} json æ’å…¥å¯èƒ½ä¼šæ›´å¿«äº›ï¼Œjsonbçš„è¯»å–æ›´å¿« æ“ä½œç¬¦ json ,jsonb æ“ä½œç¬¦ æ“ä½œç¬¦ å³æ“ä½œæ•°ç±»å‹ æè¿° ç¤ºä¾‹ ç»“æœ -&amp;gt; int è·å–JSONæ•°ç»„å…ƒç´ ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰ select</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“æ—¥å¿—åˆ†æ</title>
      <link>https://zhangeamon.top/postgres/pg_elk/</link>
      <pubDate>Fri, 05 Nov 2021 09:44:17 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_elk/</guid>
      <description>æ•°æ®åº“æ—¥å¿—åˆ†æ æ•´ä½“æ¶æ„ filebeat -&amp;gt; logstash -&amp;gt; elasticseach -&amp;gt; kibana filebeat æ”¶é›†æ—¥å¿— logstash ä¸­è½¬åŠæ—¥å¿—è§„åˆ™åŒ¹é…è¿‡æ»¤ elasticsearch æ—¥å¿—å­˜å‚¨æ£€ç´¢åº“ kibana æŸ¥çœ‹ç•Œé¢ postgresql log_destination = &#39;csvlog&#39; logging_collector = &#39;on&#39; log_filename = &#39;postgresql-%Y-%m-%d_%H%M%S.log&#39; log_rotation_age = &#39;1d&#39; log_rotation_size = &#39;100MB&#39; log_min_messages = &#39;info&#39; log_min_duration_statement = &#39;1000&#39; log_statement = &#39;ddl&#39; filebeat filebeat.inputs: - type: log enabled: true paths: - /var/lib/pgsql/***/postgresql-*.csv fields: log_topics: postgresql multiline.pattern: &#39;^[[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}.[0-9]{3} [A-Z]{3}&#39; multiline.negate: true multiline.match: after filebeat.config.modules: path: ${path.config}/modules.d/*.yml reload.enabled: false setup.template.settings: index.number_of_shards: 1 tags: [&amp;quot;postgesql&amp;quot;] setup.kibana: output.logstash: hosts: [&amp;quot;*.*.*.*:5044&amp;quot;] processors: - add_host_metadata: ~ - add_cloud_metadata: ~ logstash # # this config is use for version logstash 7.3.1 # input { beats { port =&amp;gt; 5044 } #sdtin{ # #} } #</description>
    </item>
    
    <item>
      <title>å®¢æˆ·ç«¯æ•…éšœè½¬ç§»</title>
      <link>https://zhangeamon.top/postgres/libpg/</link>
      <pubDate>Thu, 22 Jul 2021 11:04:27 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/libpg/</guid>
      <description>å¤šä¸»æœºè¿æ¥ PostgreSQL libpq æ˜¯æ•°æ®åº“çš„ä¸€ä¸ªè¿æ¥é©±åŠ¨ï¼Œæ”¯æŒå¤šä¸»æœºé…ç½®ï¼ŒåŒæ—¶æ”¯æŒtarget_session_attrs ä¸»æœºè§’è‰²åˆ¤æ–­é…ç½®ã€‚ å½“é…ç½®äº†å¤šä¸ªä¸»æœºæ—¶ï¼Œä¼šæŒ‰é¡ºåºå°è¯•è¿æ¥ï¼Œä¹‹é“è·å–åˆ°æˆåŠŸçš„è¿æ¥ä¸ºæ­¢ã€‚ åˆ©ç”¨libpqçš„è¿™ä¸ªç‰¹æ€§ï¼Œç»“åˆæ•°æ®åº“è‡ªåŠ¨HAçš„ä¸€äº›è½¯ä»¶ï¼Œå¯ä»¥å®ç°åœ¨ä¸å¼•å…¥VIPä»¥åŠä¸­é—´è·¯ç”±èŠ‚ç‚¹çš„</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨prepareé¢„ç¼–è¯‘SQL</title>
      <link>https://zhangeamon.top/postgres/prepare/</link>
      <pubDate>Wed, 21 Jul 2021 16:37:53 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/prepare/</guid>
      <description>ä½¿ç”¨é¢„ç¼–è¯‘ä¼˜åŠ¿ä»‹ç» åœ¨æ‰§è¡Œä¸€ä¸ªSQLæ—¶ï¼Œé¦–å…ˆç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼ˆè¿›è¡Œè¯­ä¹‰åˆ†æã€è¯æ³•è§£æã€é€»è¾‘ä¼˜åŒ–ã€ç‰©ç†ä¼˜åŒ–ï¼‰ã€æ‰§è¡Œã€ç»“æœä¼ è¾“ç­‰æ“ä½œã€‚ å¦‚æœä¸€ä¸ªSQLåœ¨åº”ç”¨ä¸­åå¤ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ­¤SQLå‚æ•°åŒ–ï¼Œåªåšä¸€æ¬¡prepareï¼Œåé¢æ‰§è¡Œæ—¶å°±ä¸éœ€è¦è¿›è¡Œå‰é¢æ‰§è¡Œè®¡åˆ’çš„ç”Ÿæˆæ“ä½œï¼Œç›´æ¥ä½¿ç”¨prepareå¥½çš„æ‰§</description>
    </item>
    
    <item>
      <title>ç‰©åŒ–è§†å›¾</title>
      <link>https://zhangeamon.top/postgres/materialized/</link>
      <pubDate>Wed, 21 Jul 2021 15:43:34 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/materialized/</guid>
      <description>ç‰©åŒ–è§†å›¾ ç‰©åŒ–è§†å›¾ä¸æ™®é€šè§†å›¾çš„åŒºåˆ«åœ¨äºï¼Œç‰©åŒ–è§†å›¾æ˜¯ç‰©ç†ä¸ŠçœŸå®å­˜åœ¨çš„è¡¨ã€‚ ç‰©åŒ–è§†å›¾çš„åˆ›å»º \h create materialized view Command: CREATE MATERIALIZED VIEW Description: define a new materialized view Syntax: CREATE MATERIALIZED VIEW [ IF NOT EXISTS ] table_name [ (column_name [, ...] ) ] [ USING method ] [ WITH ( storage_parameter [= value] [, ... ] ) ] [ TABLESPACE tablespace_name ] AS query [ WITH [ NO ] DATA ] ä¸creat table as åŸºæœ¬ç›¸åŒï¼Œä½†æ˜¯ç‰©åŒ–è§†å›¾ä¸åŒäºtable çš„æ˜¯ç‰©åŒ–æ—¶å€™ä¸­çš„æ•°æ®å†…å®¹å¯ä»¥</description>
    </item>
    
    <item>
      <title>PGé«˜å¯ç”¨ repmgr æ­å»º</title>
      <link>https://zhangeamon.top/postgres/repmgr/</link>
      <pubDate>Wed, 07 Apr 2021 10:12:02 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/repmgr/</guid>
      <description>åŸºäºRepmgrå®ç°æ•°æ®åº“é«˜å¯ç”¨ å®‰è£…ç¯å¢ƒ è½¯ä»¶ç¯å¢ƒ postgres 10 repmgr 5.3.2 centos7 ç½‘ç»œç¯å¢ƒ IPåœ°å€ è¿è¡Œè½¯ä»¶ 10.10.2.12/node1 repmgr,repmgrd,pg 10.10.2.13/node2 repmgr,repmgrd,pg 10.10.2.14/node3 repmgr,repmgrd,pg å‰æœŸå‡†å¤‡ hosts æ–‡ä»¶é…ç½® vi /etc/hosts # 10.10.2.12 node1 10.10.2.13 node2 10.10.2.14 node3 å®‰è£…PG10 $ yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm $ yum update -y $ yum install -y postgresql10-server postgresql10 postgresql10-contrib # åªæœ‰ä¸»åº“éœ€è¦åˆå§‹åŒ– $ sudo su postgres -c &amp;quot;/usr/pgsql-10/bin/initdb --data-checksums -D /var/lib/pgsql/10/data&amp;quot; å®‰è£…repmgr $ yum install -y repmgr10.x86_64 æå‡postgres ç”¨æˆ·å…·æœ‰éƒ¨åˆ†sudo æ‰§è¡Œ</description>
    </item>
    
    <item>
      <title>Backgroud Writer è¿›ç¨‹</title>
      <link>https://zhangeamon.top/postgres/bgwriter/</link>
      <pubDate>Wed, 31 Mar 2021 15:13:50 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/bgwriter/</guid>
      <description>ä¸»è¦ä½œç”¨ è´Ÿè´£å°†shared buffer ä¸­çš„å†…å®¹åˆ·å†™åˆ°ç£ç›˜ä¸­ï¼Œ9.1ç‰ˆä¹‹åéƒ¨åˆ†å†…å®¹äº¤ç»™checkpointå®Œæˆã€‚ å‚æ•°é…ç½® # - Background Writer - #bgwriter_delay = 200ms # 10-10000ms between rounds #bgwriter_lru_maxpages = 100 # 0-1000 max buffers written/round #bgwriter_lru_multiplier = 2.0 # 0-10.0 multiplier on buffers scanned/round #bgwriter_flush_after = 512kB # measured in pages, 0 disables bgwriter_delay ä¸¤æ¬¡å†™å…¥ä»»åŠ¡ä¹‹é—´çš„ç¡çœ é—´éš”æ—¶é—´ bgwriter_lru_maxpages æ¯æ¬¡bgwriterä»»åŠ¡å†™bufferçš„æœ€å¤§pageæ•°ï¼Œä¸€æ—¦è¾¾</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“è¯•å›¾ä¹‹ pg_stat_bgwriter</title>
      <link>https://zhangeamon.top/postgres/view_pg_stat_bgwriter/</link>
      <pubDate>Wed, 31 Mar 2021 09:32:17 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/view_pg_stat_bgwriter/</guid>
      <description>ä»‹ç» å¯æŸ¥çœ‹ backgroud writerï¼Œ checkpoint ï¼Œbackend è¿›ç¨‹åˆ·å†™ Shared buffer æƒ…å†µè§†å›¾ pgæ•°æ®åº“åœ¨å†™å…¥æ—¶å…ˆåœ¨å†…å­˜ä¸­æ›´æ–°shared buffer ï¼Œç„¶åæœ‰checkpointæœºåˆ¶å°†è„æ•°æ®åˆ·å†™åˆ°ç£ç›˜ã€‚ è§†å›¾ select * from pg_stat_bgwriter ; -[ RECORD 1 ]---------+------------------------------ checkpoints_timed | 64017 checkpoints_req | 458 checkpoint_write_time | 9608302902 checkpoint_sync_time | 1189286 buffers_checkpoint | 578367652 buffers_clean | 329022 maxwritten_clean | 2353 buffers_backend | 29802728 buffers_backend_fsync | 0 buffers_alloc | 83826180 stats_reset | 2020-08-20 19:41:20.491551+08 è´Ÿè´£å°†shared buffer ä¸­çš„å†…å®¹</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“é«˜å¯ç”¨è®¾è®¡åˆ†æ</title>
      <link>https://zhangeamon.top/postgres/ha_fd/</link>
      <pubDate>Tue, 23 Mar 2021 16:32:14 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/ha_fd/</guid>
      <description>åŸºæœ¬æ¦‚å¿µ é›†ç¾¤ï¼š ä¸€ç»„å¤šä¸ªåŒæ—¶å¯¹å¤–æä¾›ç›¸åŒæœåŠ¡çš„å®ä½“æœºç»„æˆä¸€ä¸ªé›†ç¾¤ã€‚è¿™é‡Œçš„é›†ç¾¤ä¸ºä¸»ä»ç»“æ„ï¼Œå¯å†™èŠ‚ç‚¹ä¸ºä¸»èŠ‚ç‚¹ï¼Œå…¶ä»–åªè¯»èŠ‚ç‚¹ä¸ºä»èŠ‚ç‚¹ã€‚ é«˜å¯ç”¨ï¼š åœ¨å‘ç”Ÿå±€éƒ¨æ•…éšœæ—¶å¯¹æ•´ä½“ä¸šåŠ¡å½±å“å¾ˆä½ã€‚å³ä¸å¯ç”¨çš„æ—¶é—´è¦å°½é‡çš„çŸ­ã€‚ å¯¹å¤–éƒ¨åº”ç”¨çš„è®¿é—®æ¥è¯´ï¼Œæ— éœ€å…³æ³¨å¦‚ä½•å®ç°ï¼Œå¦‚åŒåªè®¿é—®ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¹¶èƒ½å¾—åˆ°æŒç»­çš„æœåŠ¡èƒ½åŠ›ã€‚</description>
    </item>
    
    <item>
      <title>æµå¤åˆ¶åŒæ­¥çº§åˆ«</title>
      <link>https://zhangeamon.top/postgres/replication02/</link>
      <pubDate>Wed, 17 Mar 2021 11:14:17 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/replication02/</guid>
      <description>æµå¤åˆ¶è¿‡ç¨‹ synchronous_commit = on ï¼‰ # synchronization level; on default # off, local, remote_write, or on åŒæ­¥çº§åˆ« remote_applyï¼šäº‹åŠ¡commitæˆ–rollbackæ—¶ï¼Œç­‰å¾…å…¶redoåœ¨primaryã€ä»¥åŠåŒæ­¥standby(s)å·²æŒä¹…åŒ–ï¼Œå¹¶ä¸”å…¶redoåœ¨åŒæ­¥ standby(s)å·²applyã€‚ onï¼šäº‹åŠ¡commitæˆ–rollbackæ—¶ï¼Œ</description>
    </item>
    
    <item>
      <title>pg_rman å¤‡ä»½æ¢å¤æ•°æ®åº“</title>
      <link>https://zhangeamon.top/postgres/pg_rman/</link>
      <pubDate>Tue, 09 Mar 2021 13:35:31 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_rman/</guid>
      <description>é€‚ç”¨åœºæ™¯ PG_RMAN åŸºäºæœ¬åœ°æ•°æ®æ‹·è´çš„æ–¹å¼ï¼Œè¦æ±‚ä¸æ•°æ®åº“éœ€è¦å®‰è£…åœ¨åŒä¸€ä¸ªæœºå™¨èŠ‚ç‚¹ä¸Šã€‚ é€‚ç”¨äºé¡¹ç›®åˆæœŸï¼Œå¯¹æ•°æ®åº“çš„è§„åˆ’å¤„äºåˆçº§é˜¶æ®µã€‚å®ä½“æœºä¸å……åˆ†çš„æƒ…å†µæ˜¯ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚ æ•°æ®åº“ä½¿ç”¨ssdç›˜ï¼Œå¤‡ä»½ç£ç›˜é‡‡ç”¨ä¼ä¸šsataå¤§ç›˜ã€‚æˆ–nfsç½‘ç›˜ç­‰ã€‚ PG_RMAN æ”¯æŒå…¨å¤‡ä»½ï¼Œå¢é‡å¤‡ä»½ï¼Œå¤‡ä»½éªŒè¯ï¼Œä¿ç•™ç­–ç•¥ç­‰ åº”ç”¨è½¯ä»¶åŒ…åœ°å€ https://github.com/ossc-db/pg_rman/releases åŸº</description>
    </item>
    
    <item>
      <title>Patroni é«˜å¯ç”¨ç®¡ç†è¿›é˜¶</title>
      <link>https://zhangeamon.top/postgres/patroni02/</link>
      <pubDate>Fri, 05 Mar 2021 17:06:18 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/patroni02/</guid>
      <description>å®Œæˆç›®æ ‡ ä¸»ä»åŒæ­¥ç­–ç•¥ å¼‚åœ°å¤šæœºæˆ¿ç­–ç•¥ failover è§¦å‘è¯¦æƒ… è®¿é—®è®¤è¯ watch-dog é…ç½®æ–‡ä»¶è¯¦æƒ… fencing DCS å¤±æ•ˆå¤„ç† åŠ å…¥èŠ‚ç‚¹å¤åˆ¶æ•°æ®é™æµ ä¸»ä»åˆ‡æ¢æµé‡,é¿å…é‡æ–°æ‹‰å– çº§è”å¤åˆ¶ callback æ—¥å¿—&amp;amp;ç›‘æ§ ä¸»ä»åŒæ­¥ç­–ç•¥ æ•°æ®åº“ä¸»ä»ä¹‹é—´åŒæ­¥ç±»å‹ Synchronous state of this standby server. Possible values are: async: This standby server is asynchronous. potential: This standby server is now asynchronous, but can potentially become synchronous if one of current synchronous ones fails. sync: This standby server is synchronous. quorum: This standby server is considered as</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ä¼˜åŒ–æ€è€ƒ-æ€§èƒ½ä¼˜åŒ–</title>
      <link>https://zhangeamon.top/postgres/thinking_in_db_performance/</link>
      <pubDate>Fri, 26 Feb 2021 13:33:23 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/thinking_in_db_performance/</guid>
      <description>ä¸ºä»€ä¹ˆè¦ä¼˜åŒ– é¦–å…ˆäº†è§£ä¸€ä¸ªæ¦‚å¿µï¼Œä»€ä¹ˆæ˜¯Â·ç†µå¢Â· ç‰©ç†å®šä¹‰ï¼šç†µå¢è¿‡ç¨‹æ˜¯ä¸€ä¸ªè‡ªå‘çš„ç”±æœ‰åºå‘æ— åºå‘å±•çš„è¿‡ç¨‹(Bortz, 1986; Roth, 1993) åœ¨ä¸€ä¸ªå­¤ç«‹çš„ç³»ç»Ÿé‡Œï¼Œå¦‚æœæ²¡æœ‰å¤–åŠ›åšå·¥ï¼Œå…¶æ€»æ··ä¹±åº¦ï¼ˆå³ç†µï¼‰ä¼šä¸æ–­å¢å¤§ï¼Œç›´è‡³ç³»ç»Ÿå½»åº•å˜å¾—æ— åº ä»ç³»ç»Ÿè½¯ä»¶çš„è§’åº¦ï¼š ä»åº”ç”¨ç³»ç»Ÿä¸Šçº¿é‚£ä¸€åˆ»å¼€å§‹ï¼Œéšç€ç”¨æˆ·é‡çš„å¢åŠ ã€ä¸šåŠ¡åŠŸèƒ½çš„æŒç»­</description>
    </item>
    
    <item>
      <title>hot update</title>
      <link>https://zhangeamon.top/postgres/hotupdate/</link>
      <pubDate>Thu, 14 Jan 2021 13:49:11 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/hotupdate/</guid>
      <description>What is HOT HOTæ˜¯â€œHeap Only Tupleâ€ï¼ˆä»…å…ƒç»„å †ï¼‰çš„ç¼©å†™, ç”¨æ¥æé«˜updateæ•ˆç‡ã€‚ è¡Œçš„æ–°ç‰ˆæœ¬å’Œæ—§ç‰ˆæœ¬ä½äºåŒä¸€å—ä¸­æ—¶ï¼Œè¯¥è¡Œçš„å¤–éƒ¨åœ°å€ï¼ˆåŸå§‹è¡ŒæŒ‡é’ˆï¼‰ä¿æŒä¸å˜ï¼Œåˆ©ç”¨hot linkæŒ‡é’ˆè¿›è¡Œè½¬å‘åœ°å€ã€‚ç´¢å¼•ä¸éœ€è¦ä»»ä½•æ”¹åŠ¨ã€‚ å‰ææ¡ä»¶ åŒ…å«æ›´æ–°è¡Œçš„å—ä¸­å¿…é¡»æœ‰è¶³å¤Ÿçš„ç©ºé—´ åœ¨å·²ä¿®æ”¹å€¼çš„ä»»ä½•åˆ—ä¸Šå‡æœªå®šä¹‰</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ä¼˜åŒ–æ€è€ƒ - æ¨¡å—è°ƒä¼˜</title>
      <link>https://zhangeamon.top/postgres/thinking_in_db_tune/</link>
      <pubDate>Wed, 13 Jan 2021 09:04:35 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/thinking_in_db_tune/</guid>
      <description>å¼€å§‹ä¹±è¯´ ä¸»è¦æ˜¯ç»“åˆpostgresæ•°æ®åº“è‡ªèº«ç‰¹ç‚¹ï¼Œæ ¹æ®å…·ä½“çš„ä¸šåŠ¡åœºæ™¯ï¼Œä½œå‡ºç›¸åº”è°ƒæ•´ï¼Œä½¿å…¶æ›´åŠ åˆç†ã€‚ æ•°æ®åº“ä½œä¸ºä¸€ä¸ªæ•´ä½“å¯¹å¤–æä¾›æœåŠ¡ï¼Œå•æ˜¯å…¶å†…éƒ¨æ˜¯ç”±ä¸åŒçš„åŠŸèƒ½æ¨¡å—ç»„æˆï¼Œç›¸äº’åè°ƒæ¥å…±åŒå®Œæˆä»»åŠ¡ã€‚ å„ä¸ªåŠŸèƒ½æ¨¡å—å®Œæˆä¸åŒçš„åŠŸèƒ½ï¼Œæ¯ä¸ªæ¨¡å—çš„ç‰¹ç‚¹ä¹Ÿä¸åŒï¼Œåœ¨è°ƒæ•´çš„æ—¶å€™è‡³å°‘éœ€è¦ç†è§£å„ä¸ªæ¨¡å—å®ç°çš„åŸºæœ¬</description>
    </item>
    
    <item>
      <title>unlogged table</title>
      <link>https://zhangeamon.top/postgres/unlogged_table/</link>
      <pubDate>Tue, 12 Jan 2021 10:21:36 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/unlogged_table/</guid>
      <description>ä»‹ç» åœ¨å†™æ•°æ®çš„æ—¶å€™ä¸è®°å½•walçš„è¡¨ã€‚ åœ¨æ„å¤–å‘ç”Ÿæ—¶è¡¨ä¸­çš„æ•°æ®è¢«trunce ã€‚å¦‚æ–­ç”µã€ ä¸»è¿›ç¨‹kill ã€scrash ç­‰ã€‚ æ­£å¸¸å…³é—­é‡å¯æ•°æ®åº“æ—¶æ•°æ®ä¸ä¼šä¸¢å¤±ã€‚ ä¼˜ç‚¹ï¼š æé«˜å†™å…¥æ•ˆç‡ ä¸è¶³ï¼š æ•°æ®å®‰å…¨æ€§ä¸èƒ½å¾—åˆ°ä¿éšœã€‚ ç”±äºæ²¡æœ‰wal æµå¤åˆ¶ä»åº“ä¸èƒ½åŒæ­¥ åº”ç”¨åœºæ™¯ï¼š æ•°æ®å¯ä¸¢å¤±ï¼Œå¦‚é¢‘ç¹æ›´æ–°ï¼Œåªä¿ç•™æœ€åçŠ¶æ€ä¿¡æ¯</description>
    </item>
    
    <item>
      <title>è¯¯æ“ä½œé—ªå›</title>
      <link>https://zhangeamon.top/postgres/reback/</link>
      <pubDate>Mon, 11 Jan 2021 17:19:06 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/reback/</guid>
      <description>åŸç† åˆ©ç”¨mvccåŸç†ï¼Œæ•°æ®åœ¨åˆ é™¤æˆ–æ›´æ–°æ—¶åªæ˜¯æ ‡è®°ä¸ºåˆ é™¤ã€‚å½“æ²¡æœ‰å‘ç”Ÿè¿‡gcæ—¶å†å²æ•°æ®ä»ç„¶å­˜åœ¨ã€‚åªæ˜¯å¯¹å½“å‰äº‹åŠ¡ä¸å¯è§ã€‚ é€šè¿‡ä¿®æ”¹å½“å‰äº‹åŠ¡å·ä¸ºè¯¯æ“ä½œå‰çš„äº‹åŠ¡å·å°±å¯ä»¥çœ‹åˆ°å†å²æ•°æ®ã€‚ ä¾‹å¦‚ T1 ï¼ˆæ·»åŠ æ•°æ®ï¼‰ T2 - T8ï¼ˆå…¶ä»–æ“ä½œï¼‰ T9ï¼ˆåˆ é™¤äº†T1åŠ å…¥çš„æ•°æ®ï¼‰T10&amp;hellip; (å…¶ä»–æ“ä½œ)ã€‚ è‡ªéœ€è¦å°†</description>
    </item>
    
    <item>
      <title>é«˜çº§SQL</title>
      <link>https://zhangeamon.top/postgres/high_level_sql/</link>
      <pubDate>Mon, 11 Jan 2021 17:05:25 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/high_level_sql/</guid>
      <description>åˆ†ç»„é›† æ’åºé›† å‡è±¡é›† çª—å£å‡½æ•° é€’å½’ é€’å½’åº”ç”¨ é€’å½’åŠ é€Ÿcount(distint) æŸ¥è¯¢ã€‚ ä½¿ç”¨åœºæ™¯ï¼Œæ•°æ®åˆ†å¸ƒï¼šå¤§æ•°æ®é›†ä½†å…¶ä¸­çš„ç±»å‹å´å¾ˆå°‘ -- åˆ›å»ºè¡¨ test1=# create table recurive_t(user_id int,free float,info text); CREATE TABLE -- åŠ å…¥æ•°æ® test1=# insert into recurive_t select 1 ,generate_series(0,1000000),&#39;user 1 pay !!!&#39;; test1=# insert into recurive_t select 2 ,generate_series(0,2000000),&#39;user 2 pay !!!&#39;; test1=# insert into recurive_t select 3 ,generate_series(0,3000000),&#39;user 3 pay !!!&#39;; test1=# insert into recurive_t select 4 ,generate_series(0,4000000),&#39;user 4 pay !!!&#39;; test1=# insert into recurive_t select 5 ,generate_series(0,4000000),&#39;user 5 pay !!!&#39;; test1=# analyze recurive_t ; ANALYZE -- count(distinct()) æŸ¥è¯¢</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ä¼˜åŒ–æ€è€ƒ - ç»“æ„è®¾è®¡</title>
      <link>https://zhangeamon.top/postgres/thinking_in_db_fd/</link>
      <pubDate>Mon, 11 Jan 2021 10:10:42 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/thinking_in_db_fd/</guid>
      <description>DB ä¸ APP çš„ä¸åŒ æœ‰æ— çŠ¶æ€ æ— çŠ¶æ€åº”ç”¨ï¼Œæ¯ä¸ªå®ä¾‹æä¾›çš„æœåŠ¡éƒ½æ˜¯ç­‰ä»·ã€å¯¹ç­‰çš„ã€‚APP åº”ç”¨ä¸ºæ— çŠ¶æ€åº”ç”¨ï¼ŒDBåº”ç”¨ä¸ºæœ‰çŠ¶æ€åº”ç”¨ã€‚ æ•°æ®åº“æ­£æ˜¯å› ä¸ºæœ‰çŠ¶æ€ï¼Œæ‰€ä»¥ç»´æŠ¤èµ·æ¥æ›´æœ‰æŒ‘æˆ˜ã€‚ APP åœ¨é¢å¯¹å¤§é‡é«˜å¹¶å‘è¯·æ±‚æ—¶å¯ä»¥æ— æ‰€é¡¾åŠçš„å¢åŠ å®ä¾‹ï¼ŒåŠ æœºå™¨è¿›è¡Œæ‰©å®¹ã€‚å¤„ç†èƒ½é‡Œä¹Ÿä¼šå°†å¾—åˆ°çº¿æ€§æå‡ã€‚ç®€å•ç²—æš´åˆæœ‰æ•ˆã€‚ DB é¢å¯¹åŒæ ·çš„å‹</description>
    </item>
    
    <item>
      <title>auto vacuum è§¦å‘æœºåˆ¶</title>
      <link>https://zhangeamon.top/postgres/auto_vacuum_trigger/</link>
      <pubDate>Fri, 08 Jan 2021 09:20:56 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/auto_vacuum_trigger/</guid>
      <description>æ•°æ®åº“è‡ªåŠ¨åƒåœ¾å›æ”¶è§¦å‘æ¡ä»¶åˆ†æ åœ¨postgres ä¸­ åƒåœ¾å›æ”¶çš„é‡è¦æ„ä¹‰åŠåœ¨æ‰§è¡Œåƒåœ¾å›æ”¶æ—¶å…·ä½“éƒ½åšäº†äº›ä»€ä¹ˆå¾ˆå¤šåœ°æ–¹éƒ½æœ‰ä»‹ç»ã€‚ ä½†æ˜¯ä½•æ—¶è§¦å‘åƒåœ¾å›æ”¶ï¼Œå³åƒåœ¾å›æ”¶çš„è§¦å‘æ¡ä»¶æ˜¯ä»€ä¹ˆã€‚ å®˜ç½‘çš„ä»‹ç»ä¸€èˆ¬æ˜¯æœ‰å¦‚ä¸‹å‡ ä¸ªå‚æ•°å†³å®š #autovacuum = on # Enable autovacuum subprocess? &#39;on&#39; #autovacuum_vacuum_threshold = 50 # min number of row updates before vacuum #autovacuum_analyze_threshold = 50 # min number of row updates before analyze #autovacuum_vacuum_scale_factor = 0.2 # fraction of table size</description>
    </item>
    
    <item>
      <title>åŸç”Ÿåˆ†åŒºè¡¨</title>
      <link>https://zhangeamon.top/postgres/partition/</link>
      <pubDate>Thu, 31 Dec 2020 10:17:03 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/partition/</guid>
      <description>åˆ†åŒºè¡¨ æ•°æ®åº“åˆ†åŒºæ˜¯ä¸€ç§å°†æ•°æ®åšç‰©ç†åˆ†ç‰‡çš„æ•°æ®åº“è®¾è®¡æŠ€æœ¯ï¼Œè™½ç„¶åˆ†åŒºæŠ€æœ¯å¯ä»¥æœ‰å¤šç§å®ç°æ–¹æ³•ï¼Œ ä½†å…¶ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†åœ¨ç‰¹å®šçš„SQLæ“ä½œä¸­å‡å°‘æ•°æ®è¯»å–çš„æ€»é‡ä»¥ç¼©å‡å“åº”æ—¶é—´ã€‚ ä½¿ç”¨åˆ†åŒºè¡¨å¯¹åº”ç”¨ç¨‹åºæ˜¯é€æ˜çš„ï¼Œå¯¹äºINSERT,UPDATE,DELETE,SELECTæ“ä½œï¼Œéƒ½åªéœ€è¦å¯¹çˆ¶è¡¨tblè¿›è¡Œæ“</description>
    </item>
    
    <item>
      <title>è·¨åº“æ“ä½œ</title>
      <link>https://zhangeamon.top/postgres/pg_fdw/</link>
      <pubDate>Thu, 24 Dec 2020 09:11:54 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_fdw/</guid>
      <description>dblink https://www.cnblogs.com/lottu/p/13331387.html fdw https://www.cnblogs.com/lottu/p/13345187.html æ³¨æ„äº‹é¡¹ æŸ¥è¯¢æ¡ä»¶ä¸‹æ¨ï¼Œæ–°ç‰ˆæœ¬åŠŸèƒ½æ›´å…¨ ddl æ“ä½œ , fdw å¦‚æœç”¨äºå†å²å½’æ¡£</description>
    </item>
    
    <item>
      <title>æ‰¾å›supper user æƒé™</title>
      <link>https://zhangeamon.top/postgres/reback_supper_user/</link>
      <pubDate>Tue, 22 Dec 2020 17:12:53 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/reback_supper_user/</guid>
      <description>èƒŒæ™¯ æ„å¤–åˆ é™¤postgres supper user æƒé™ æ‰¾å›æ–¹æ³• å…³é—­æ•°æ®åº“ ç”¨å•ç”¨æˆ·æ¨¡å¼é‡æ–°å¯åŠ¨ /usr/lib/postgresql/xxxx/bin/postgres --single -D $PGDATA é‡æ–°è®¾ç½®supper user æƒé™ alter user postgres with superuser;</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ç›‘æ§æŒ‡æ ‡</title>
      <link>https://zhangeamon.top/postgres/monitor_explain/</link>
      <pubDate>Fri, 20 Nov 2020 14:46:54 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/monitor_explain/</guid>
      <description>å®ä½“æœº ç¡¬ç›˜ç©ºé—´ cupåˆ©ç”¨ç‡ å†…å­˜åˆ©ç”¨ç‡ IO ç½‘ç»œå¸¦å®½ tcpè¿æ¥æƒ…å†µ æ¸©åº¦ æ•°æ®åº“å¹´é¾„ -- æ•°æ®åº“database å¹´é¾„ select datname,age(datfrozenxid),pg_size_pretty(pg_database_size(oid)) from pg_database order by age(datfrozenxid) desc limit 10 ; -- è¡¨å¹´é¾„ select relname,age(relfrozenxid), pg_size_pretty(pg_table_size(oid)) from pg_class where relkind in (&#39;t&#39;,&#39;r&#39;) order by age(relfrozenxid) desc limit 10; è¯´æ˜ï¼š å½“ageåˆ°è¾¾2äº¿ï¼ˆé»˜è®¤ï¼‰æ—¶è§¦å‘è‡ªåŠ¨å›å·ï¼ŒæœŸé—´ä¼šå¤§é‡å ç”¨ç³»ç»Ÿèµ„æºã€‚æå‰åšå¥½ç›‘æ§é¿å…åœ¨ä¸šåŠ¡é«˜å³°æ—¶å‘ç”Ÿã€‚å¯åœ¨åº“çº§åˆ«æ“ä½œ</description>
    </item>
    
    <item>
      <title>kylinç³»ç»Ÿpostgresqlç¼–è¯‘å®‰è£…</title>
      <link>https://zhangeamon.top/postgres/compile_kylin/</link>
      <pubDate>Mon, 16 Nov 2020 15:26:59 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/compile_kylin/</guid>
      <description>èƒŒæ™¯ éº’éºŸç³»ç»Ÿé»˜è®¤è‡ªå¸¦postgresql10.5 å®‰è£…è¿‡ç¨‹ä¸centosåŸºæœ¬ç›¸åŒ , æ³¨æ„äº‹é¡¹ 1 å®‰è£…postgresql-dev 2 ç¼–è¯‘ postgis æ—¶./configure &amp;ndash;with-pgconfig=/usr/bin/pg_config ä½†æ˜¯å¦‚æœæƒ³å®‰è£…å…¶ä»–ç‰ˆæœ¬çš„postgres éœ€ä¸€ç•ªå‘¨æŠ˜ é¦–å…ˆç¬¬ä¸€ä¸ªé—®é¢˜éº’éºŸç³»ç»Ÿå¯¹opensslè¿‡è¿›è¡Œæ”¹é€ ã€‚åœ¨ç¼–è¯‘postgresæ”¯</description>
    </item>
    
    <item>
      <title>åˆ›å»ºåªè¯»ç”¨æˆ·</title>
      <link>https://zhangeamon.top/postgres/readonly/</link>
      <pubDate>Tue, 08 Sep 2020 09:28:59 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/readonly/</guid>
      <description>åˆ›å»ºåªè¯»ç”¨æˆ·readonly 1.åˆ›å»ºä¸€ä¸ªç”¨æˆ·åä¸ºreadonlyå¯†ç ä¸ºropassçš„ç”¨æˆ· CREATE USER readonly WITH ENCRYPTED PASSWORD &#39;ropass&#39;; 2.ç”¨æˆ·åªè¯»äº‹åŠ¡ alter user readonly set default_transaction_read_only=on; 3.æŠŠæ‰€æœ‰åº“çš„è¯­è¨€çš„USAGEæƒé™ç»™åˆ°readonly GRANT USAGE ON SCHEMA public to readonly; 4.æˆäºˆselectæƒé™(è¿™å¥è¦è¿›å…¥å…·ä½“æ•°æ®åº“æ“ä½œåœ¨å“ªä¸ªdbç¯å¢ƒæ‰§è¡Œå°±æˆäºˆé‚£ä¸ªdbçš„</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ OOM é¢„é˜²</title>
      <link>https://zhangeamon.top/postgres/oom/</link>
      <pubDate>Tue, 30 Jun 2020 09:26:42 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/oom/</guid>
      <description>é™ä½ä¸»è¿›ç¨‹è¢«OOM kill æ‰çš„é£é™© restart_after_crash é»˜è®¤å´©æºƒé‡å¯ postgres=# show restart_after_crash; restart_after_crash --------------------- on (1 row) vm.overcommit # vi /etc/sysctl.conf # 0 è¡¨ç¤ºå†…æ ¸å°†æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜ä¾›åº”ç”¨è¿›ç¨‹ä½¿ç”¨ï¼›å¦‚æœæœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜ï¼Œå†…å­˜ç”³è¯·å…è®¸ï¼›å¦åˆ™ï¼Œå†…å­˜ç”³è¯·å¤±è´¥ï¼Œå¹¶æŠŠé”™è¯¯è¿”å›ç»™åº”ç”¨è¿›ç¨‹ # 1 è¡¨ç¤ºå†…æ ¸å…è®¸åˆ†é…æ‰€æœ‰çš„ç‰©ç†å†…å­˜ï¼Œè€Œä¸ç®¡å½“å‰çš„å†…å­˜çŠ¶æ€å¦‚ä½• # 2 è¡¨ç¤ºå†…æ ¸å…è®¸åˆ†é…è¶…</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ sslè®¤è¯</title>
      <link>https://zhangeamon.top/postgres/ssl/</link>
      <pubDate>Wed, 03 Jun 2020 15:06:15 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/ssl/</guid>
      <description>SSLåŒå‘è®¤è¯å’ŒSSLå•å‘è®¤è¯çš„åŒºåˆ« åŒå‘è®¤è¯ SSL åè®®è¦æ±‚æœåŠ¡å™¨å’Œç”¨æˆ·åŒæ–¹éƒ½æœ‰è¯ä¹¦ã€‚å•å‘è®¤è¯ SSL åè®®ä¸éœ€è¦å®¢æˆ·æ‹¥æœ‰CAè¯ä¹¦ï¼ŒæœåŠ¡å™¨ç«¯ä¸ä¼šéªŒè¯å®¢æˆ·è¯ä¹¦ï¼Œä»¥åŠåœ¨åå•†å¯¹ç§°å¯†ç æ–¹æ¡ˆï¼Œå¯¹ç§°é€šè¯å¯†é’¥æ—¶ï¼ŒæœåŠ¡å™¨å‘é€ç»™å®¢æˆ·çš„æ˜¯æ²¡æœ‰åŠ è¿‡å¯†çš„(è¿™å¹¶ä¸å½±å“ SSL è¿‡ç¨‹çš„å®‰å…¨æ€§)å¯†ç æ–¹æ¡ˆã€‚ è¿™æ ·ï¼ŒåŒæ–¹å…·ä½“çš„é€šè®¯å†…å®¹ï¼Œ</description>
    </item>
    
    <item>
      <title>å·¥ä½œä¸­æ‰€ä½¿ç”¨çš„postgres</title>
      <link>https://zhangeamon.top/postgres/awsome-postgres/</link>
      <pubDate>Wed, 27 May 2020 11:34:24 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/awsome-postgres/</guid>
      <description>Postgres å®é™…åº”ç”¨æ¦‚è§ˆ MVCC å¤šç‰ˆæœ¬æ§åˆ¶ ä¸€ä¸ªç»•ä¸å¼€çš„è¯é¢˜ï¼Œ ä¸»è¦æ˜¯å¯¹æŠ—è¡¨ç©ºé—´çš„è†¨èƒ€ã€‚è§£å†³åƒåœ¾å›æ”¶é—®é¢˜ï¼Œä¸»ä»åº“ä¹‹é—´ä»åº“æŸ¥è¯¢å†²çªé—®é¢˜ã€‚ ç›®å‰æ–¹æ³•æ¯æ—¥ä½å³°æœŸå®šæ—¶ vaccum ï¼Œgocronè‡ªå®šå®šæ—¶ä»»åŠ¡ ã€‚ æ ¹æ®pgstattupleå¯¹ç£ç›˜ç©ºé—´åˆ©ç”¨ç‡è¿›è¡Œåˆ†æã€‚å†³å®šæ˜¯å¦vaccum full ,pg_repack æµå¤åˆ¶ ä¸»ä»å¤åˆ¶ï¼Œè¯»å†™åˆ†ç¦»çš„åŸºç¡€ã€‚äº”ç§åŒ</description>
    </item>
    
    <item>
      <title>æ•°æ®é¢„åŠ è½½</title>
      <link>https://zhangeamon.top/postgres/pg_prewarm/</link>
      <pubDate>Wed, 27 May 2020 10:26:10 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_prewarm/</guid>
      <description>https://blog.csdn.net/Hehuyi_In/article/details/102653909</description>
    </item>
    
    <item>
      <title>Bloom ç´¢å¼•</title>
      <link>https://zhangeamon.top/postgres/index-bloom/</link>
      <pubDate>Thu, 23 Apr 2020 15:37:33 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/index-bloom/</guid>
      <description>Bloom ç´¢å¼• Bloom è¿‡æ»¤å™¨ä»£è¡¨çš„æ˜¯ä¸€ç»„å€¼ã€‚å®ƒçš„ä½œç”¨æ˜¯æ£€æµ‹ä¸€ä¸ªå…ƒç´ æ˜¯å¦å¯èƒ½å±äºé›†åˆï¼Œå®ƒå¯ä»¥å…è®¸æœ‰ä¸€äº›false positiveï¼Œä½†æ˜¯ä¸å…è®¸å­˜åœ¨false negativeã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå°½ç®¡æŸä¸ªå…ƒç´ ä¸åœ¨é›†åˆä¸­ï¼Œæµ‹è¯•ä¹Ÿå¯èƒ½è¿”å›trueã€‚ç„¶è€Œï¼Œå¦‚æœå…ƒç´ åœ¨é›†åˆä¸­ï¼Œå°±ä¸å¯èƒ½è¿”å›falseã€‚ åˆ›å»ºåœ¨ä¸€ç»„åˆ—ä¸­çš„B</description>
    </item>
    
    <item>
      <title>æ–¹æ³•å’Œå‡½æ•°</title>
      <link>https://zhangeamon.top/postgres/FunctionsandOperators/</link>
      <pubDate>Mon, 13 Apr 2020 16:15:51 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/FunctionsandOperators/</guid>
      <description>æ¡ä»¶è¡¨è¾¾å¼ https://www.postgresql.org/docs/10/functions-conditional.html postgresqlæ”¯æŒCASE,COALESCE,NULLIF,GREATEST,LEASTæ¡ä»¶è¡¨è¾¾å¼ï¼Œä½¿ç”¨å®ƒä»¬æœ‰æ—¶å€™å¯ä»¥ç®€åŒ–è®¸å¤šåŠŸèƒ½å®ç°ã€‚ CASE CASEç±»ä¼¼å…¶ä»–è¯­è¨€ä¸­çš„if/elseç­‰ï¼Œå½“ç¬¦åˆä¸åŒæ¡ä»¶æ—¶åˆ™è¿›è¡Œä¸åŒçš„è¿ç®— tbl_001è¡¨ create table tbl_001(id int,name varchar(32),sex varchar(1)); insert into tbl_001 values(1</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“æ—¥å¸¸ç®¡ç†</title>
      <link>https://zhangeamon.top/postgres/daily_management/</link>
      <pubDate>Tue, 07 Apr 2020 10:38:45 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/daily_management/</guid>
      <description>æ—¥å¸¸ç®¡ç† å¯ç”¨æ€§ ç›‘æµ‹é¡¹ å¯ç”¨æ€§ ä¸»ä» HA å…¨é‡å¤‡ä»½ å¢é‡å¤‡ä»½ æ¢å¤ ç›‘æµ‹é¡¹ ç£ç›˜ç©ºé—´ å…¨åº“ select pg_size_pretty(sum(pg_database_size(oid))) from pg_database; æ•°æ®åº“ select datname, pg_size_pretty(pg_database_size(oid)) from pg_database order by pg_database_size(oid) desc limit 10; è¡¨æ€» SELECT table_schema || &#39;.&#39; || table_name AS table_full_name, pg_size_pretty(pg_total_relation_size(&#39;&amp;quot;&#39; || table_schema || &#39;&amp;quot;.&amp;quot;&#39; || table_name || &#39;&amp;quot;&#39;)) AS size FROM information_schema.tables where table_schema = &#39;public&#39; ORDER BY pg_total_relation_size(&#39;&amp;quot;&#39; || table_schema || &#39;&amp;quot;.&amp;quot;&#39; || table_name || &#39;&amp;quot;&#39;) DESC limit 10; è¡¨ ç´¢å¼• å†·çƒ­æ•°æ® ä¸Šæ¬¡ç»Ÿè®¡ä¿¡æ¯æ›´æ–°æ—¶é—´ çƒ­è¡¨dml qps io çƒ­è¡¨qdml å†·æ•°æ® å†·ç´¢å¼• ç´¢å¼•åˆ©ç”¨ å…¨è¡¨æ‰«ææ¬¡æ•°</description>
    </item>
    
    <item>
      <title>é”ç­‰å¾…</title>
      <link>https://zhangeamon.top/postgres/lock_wait/</link>
      <pubDate>Fri, 27 Mar 2020 16:27:02 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/lock_wait/</guid>
      <description>é”ç­‰å¾…åœºæ™¯ ä¸€ä¸ªäº‹åŠ¡å°šæœªæ‰§è¡Œæäº¤æ—¶æŒæœ‰é”ï¼Œå½“å¦ä¸€ä¸ªäº‹åŠ¡éœ€è¦æŒæœ‰æ”¹è¡Œçš„é”æ—¶åˆ™éœ€è¦ç­‰å¾…ã€‚ Session 1 postgres=# \d+ wt Table &amp;quot;public.wt&amp;quot; Column | Type | Collation | Nullable | Default | Storage | Stats target | Description --------+---------+-----------+----------+---------+----------+--------------+------------- id | integer | | | | plain | | t | text | | | | extended | | postgres=# begin; BEGIN postgres=# update wt set t = &#39;aaaa&#39; where id = 1; UPDATE 1 postgres=# select pg_backend_pid(); pg_backend_pid ---------------- 20034 (1 row) Session 2 postgres=# begin ; BEGIN postgres=# update wt set t = &#39;bbbb&#39; where id = 1; Session 3 select * from pg_stat_activity; -[ RECORD 3 ]----+---------------------------------------- datid | 436980 datname</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å®‰è£… Postgres12 Ubuntu18</title>
      <link>https://zhangeamon.top/postgres/install02/</link>
      <pubDate>Thu, 19 Mar 2020 15:22:09 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/install02/</guid>
      <description>è½¯ä»¶æº echo &amp;quot;deb http://apt.postgresql.org/pub/repos/apt/ bionic-pgdg main&amp;quot; &amp;gt;&amp;gt; /etc/apt/sources.list.d/pgdg.list wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add - sudo apt-get update -y å®‰è£… apt-get install postgresql-12 postgresql-client-12 postgresql-12-postgis-2.5 postgresql-contrib -y åˆå§‹åŒ– /usr/pgsql-12/bin/postgresql-12-setup initdb å¯åŠ¨ systemctl start postgresql systemctl stop postgresql systemctl status postgresql systemctl enable postgresql é…ç½® cd /etc/postgresql/12/main/ vi postgres.conf vi pg_hba.conf</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å¹´é¾„</title>
      <link>https://zhangeamon.top/postgres/pgage/</link>
      <pubDate>Tue, 07 Jan 2020 09:47:18 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pgage/</guid>
      <description>èƒŒæ™¯ æ•°æ®åº“çš„äº‹åŠ¡æ ‡è¯†ç¬¦ä½¿ç”¨çš„æ˜¯32ä½çš„,æœ€å¤§å¯è¡¨ç¤º42ä¸ªäº¿ã€‚å½“å‰äº‹åŠ¡çš„æ•°æ®åœ¨20äº¿ä¸ªäº‹åŠ¡ä¹‹åå°†å˜çš„ä¸å¯è§ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ˆå›å·ï¼‰ï¼ŒPostgreså¼•å…¥äº†ä¸€ä¸ªå†»ç»“äº‹åŠ¡æ ‡è¯†çš„æ¦‚å¿µã€‚ å¹¶å®ç°äº†åä¸ºfreezeçš„å†»ç»“è¿‡ç¨‹ã€‚ å†»ç»“è¿‡ç¨‹ ä¸¤ç§æ¨¡å¼ æƒ°æ€§æ¨¡å¼ è¿«åˆ‡æ¨¡å¼ æƒ°æ€§æ¨¡å¼å›è·³è¿‡é¡µä¸­æ‰€æœ‰çš„æ•°æ®éƒ½ä½å¯</description>
    </item>
    
    <item>
      <title>postgres 12</title>
      <link>https://zhangeamon.top/postgres/postgres12/</link>
      <pubDate>Tue, 19 Nov 2019 08:43:36 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/postgres12/</guid>
      <description>å®‰è£…&amp;amp;å¯åŠ¨ #ä¸‹è½½æº yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm #å®‰è£…æœåŠ¡ yum install postgresql12 postgresql12-server postgresql12-contrib #åˆå§‹åŒ– /usr/pgsql-12/bin/postgresql-12-setup initdb #å¯åŠ¨æœåŠ¡ systemctl enable postgresql-12 systemctl start postgresql-12 æµå¤åˆ¶ #ä»æœº å»ºç«‹ä»åº“ pg_basebackup -h 10.1.30.13 -U postgres -F p -P -R -D /var/lib/pgsql/12/data/ --checkpoint=fast -l postgresback #ä»åº“å‡çº§ä¸ºä¸»åº“ sudo su postgres -c &amp;quot;/usr/pgsql-12/bin/pg_ctl promote -D /var/lib/pgsql/12/data/&amp;quot; recovery.conf é…ç½®æ–‡ä»¶ä¸å†æ”¯æŒï¼Œæ­¤æ–‡ä»¶ä¸­çš„å‚æ•°åˆå¹¶åˆ° postgresql.conf(postgresql.auto.conf) Recovery Target, è‹¥ recovery.conf å­˜åœ¨ï¼Œæ•°æ®åº“æ— æ³•å¯åŠ¨ æ–°å¢ recovery.signal æ ‡è¯†æ–‡ä»¶ï¼Œè¡¨ç¤ºæ•°æ®åº“å¤„äº recovery æ¨¡å¼ æ–°å¢åŠ  standby.signal</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“è§†å›¾ä¹‹ pg_stat_activity</title>
      <link>https://zhangeamon.top/postgres/view_pg_stat_activity/</link>
      <pubDate>Fri, 23 Aug 2019 13:47:12 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/view_pg_stat_activity/</guid>
      <description>ä»‹ç» å½“éœ€è¦äº†è§£æ•°æ®åº“å½“å‰è¿è¡ŒçŠ¶æ€æˆ–éœ€è¦æ’æŸ¥é—®é¢˜æ—¶ï¼Œé¦–å…ˆéœ€è¦æŸ¥çœ‹çš„å°±æ˜¯pg_stat_activityã€‚è¯¥è§†å›¾ä¸­åŒ…å«äº†ä½ æƒ³çŸ¥é“çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼Œæ­£åœ¨æ‰§è¡Œçš„æœ‰å“ªäº›sqlï¼Œå¹¶å¤„äºä½•çŠ¶æ€ã€‚ One row per server process, showing information related to the current activity of that process, such as state and current query. æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºä¸€ä¸ªç³»ç»Ÿè¿›ç¨‹ï¼Œæ˜¾ç¤ºä¸å½“å‰ä¼šè¯çš„æ´»åŠ¨è¿›ç¨‹çš„ä¸€äº›ä¿¡</description>
    </item>
    
    <item>
      <title>citus ç®€å•åº”ç”¨</title>
      <link>https://zhangeamon.top/postgres/citus01/</link>
      <pubDate>Wed, 05 Jun 2019 10:40:09 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/citus01/</guid>
      <description>å¸¸ç”¨æ–¹æ³• é›†ç¾¤ç®¡ç† åŠ å…¥èŠ‚ç‚¹ SELECT * from master_add_node(&#39;worker-101&#39;, 5432); æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€ SELECT * FROM master_get_active_worker_nodes(); select * from pg_dist_node; æ•°æ®åº“ç®¡ç† åˆ†ç‰‡è¡¨(distributed table ï¼Œ hash | append ) å‚è€ƒè¡¨(reference table æ•°æ®é‡å°) æœ¬åœ°è¡¨(åŸç”Ÿè¡¨ï¼Œæ²¡æœ‰ä»»ä½•å¤„ç†.å…¼å®¹æ€§é«˜) å¯¹è¡¨è¿›è¡Œåˆ†ç‰‡ SELECT create_distributed_table(&#39;companies&#39;, &#39;id&#39;); åˆ†ç‰‡æŸ¥çœ‹ SELECT * from pg_dist_shard; å…ƒæ•°æ®è¡¨ pg_dist_shard pg_dist_placement pg_dist_node å‚æ•° æ›´å¤šå‚è€ƒ sql é™åˆ¶ 1 éäº²å’Œæ€§è¡¨ä¹‹é—´çš„ou</description>
    </item>
    
    <item>
      <title>tpch APæµ‹è¯•</title>
      <link>https://zhangeamon.top/postgres/tpch/</link>
      <pubDate>Wed, 05 Jun 2019 09:36:21 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/tpch/</guid>
      <description>èƒŒæ™¯ä»‹ç» 24sql TPC-H åŸºå‡†æµ‹è¯• ä¸‹è½½å®‰è£… tpch-toolså®‰è£…åŒ… ä¿®æ”¹makefile.suite æ¨¡ç‰ˆ CC=gcc DATABASE-TDAT MACHINE=LINUX WORKLOAD=TPCH æ‰§è¡Œ make è¿›è¡Œç¼–è¯‘ ç”Ÿæˆæµ‹è¯•æ•°æ® ç”Ÿæˆ20Gæµ‹è¯•æ•°æ® ./dbgen -s 20 ls -lrth *.tbl è‡ªåŠ¨ç”Ÿæˆçš„æµ‹è¯•æ•°æ®æ¯è¡Œçš„ç»“å°¾å¤šä½™ä¸€ä¸ª &amp;lsquo;|&amp;rsquo; éœ€è¦å¤„ç† for i in `ls *.tbl`; do sed &#39;s/|$//&#39; $i &amp;gt; ${i/tbl/csv}; echo $i; done; åˆ›å»ºè¡¨åŠç´¢å¼• åœ¨ä¸‹é¢çš„æ–‡ä»¶ä¸­åˆ†åˆ«æ˜¯åˆ›å»ºè¡¨å’Œå¯¹åº”ç´¢å¼•çš„s</description>
    </item>
    
    <item>
      <title>è¡¨ç©ºé—´è†¨èƒ€</title>
      <link>https://zhangeamon.top/postgres/pgstattuple/</link>
      <pubDate>Wed, 22 May 2019 17:26:45 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pgstattuple/</guid>
      <description>èƒŒæ™¯ä»‹ç» ç”±äºmvccæœºåˆ¶ï¼Œæ•°æ®è¢«åˆ é™¤ååªæ˜¯è¢«æ ‡è®°ä¸ºåˆ é™¤ï¼Œå®é™…ç©ºé—´æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œè¿™æ˜¯è¡¨ç©ºé—´è†¨èƒ€çš„æ ¹æœ¬åŸå› ã€‚ ç›®å‰ç”¨äºè§£å†³è¡¨ç©ºé—´è†¨èƒ€æ–¹å¼æœ‰å¦‚ä¸‹æ–¹å¼ 1 åˆ é™¤dead tuple vacuum ,tupleè¢«æ¸…ç†ã€‚æ•°æ®åº“å¯ä»¥è‡ªåŠ¨æ‰§è¡Œautovacuum vacuum full ,tupleè¢«æ¸…ç†å¹¶ä¸”ç©ºé—´è¿ç»­ç´§å‡‘ã€‚å¼Šç«¯ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šé”è¡¨ã€‚</description>
    </item>
    
    <item>
      <title>checkpoint æ£€æŸ¥ç‚¹</title>
      <link>https://zhangeamon.top/postgres/checkpoint/</link>
      <pubDate>Wed, 13 Mar 2019 15:57:25 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/checkpoint/</guid>
      <description>ä½œç”¨ ä¸€èˆ¬checkpointä¼šå°†æŸä¸ªæ—¶é—´ç‚¹ä¹‹å‰çš„è„æ•°æ®å…¨éƒ¨åˆ·æ–°åˆ°ç£ç›˜ï¼Œä»¥å®ç°æ•°æ®çš„ä¸€è‡´æ€§ä¸å®Œæ•´æ€§ã€‚å…¶ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ç¼©çŸ­å´©æºƒæ¢å¤æ—¶é—´ã€‚ æ•°æ®åº“é è°±çš„åŸå›  ä¸€æ¡DML å†™å…¥è¿‡ç¨‹ åœ¨å†™å…¥æ•°æ®çš„æ—¶ï¼Œå½“äº‹åŠ¡æäº¤åä¿®æ”¹ä¿¡æ¯é¡ºåºåŒæ­¥å†™å…¥walã€‚shared bufferä¸­ä¿¡æ¯å¹¶ä¸æ˜¯é©¬ä¸Šè½ç›˜ã€‚å¼‚æ­¥åŒæ­¥ç£ç›˜</description>
    </item>
    
    <item>
      <title>å’¨è¯¢é” adlock</title>
      <link>https://zhangeamon.top/postgres/adlock/</link>
      <pubDate>Thu, 07 Mar 2019 16:20:16 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/adlock/</guid>
      <description>https://github.com/digoal/blog/blob/master/201805/20180524_02.md è¡Œçº§é” select .. for update select .. for update skip locked select .. for share</description>
    </item>
    
    <item>
      <title>pgpoolii è¯»å†™åˆ†ç¦»</title>
      <link>https://zhangeamon.top/postgres/pgpool2/</link>
      <pubDate>Wed, 30 Jan 2019 15:43:25 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pgpool2/</guid>
      <description>https://www.pgpool.net/docs/pgpool-II-3.5.4/doc/tutorial-zh_cn.html#dist-def https://www.xiaomastack.com/2019/08/16/postgresqlé›†ç¾¤/</description>
    </item>
    
    <item>
      <title>é€»è¾‘å¤åˆ¶</title>
      <link>https://zhangeamon.top/postgres/logical-replication/</link>
      <pubDate>Wed, 30 Jan 2019 15:42:25 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/logical-replication/</guid>
      <description>é€»è¾‘å¤åˆ¶ Postgres 10 ç‰ˆæœ¬å¼€å§‹ï¼Œ åœ¨å†…æ ¸å±‚é¢æ”¯æŒåŸºäºREDOæµçš„é€»è¾‘å¤åˆ¶ã€‚ æ§åˆ¶ç²’åº¦ä¸ºè¡¨çº§åˆ« ç‰©ç†å¤åˆ¶ç›¸åŒéƒ½æ˜¯åŸºäºwal å¯æŒ‡å®šå¤šä¸ªä¸Šæ¸¸æ•°æ®æº ä¸‹æ¸¸æ•°æ®å¯è¯»å¯å†™ å¯ç”¨äºæ•°æ®æ±‡æ€»ï¼Œæ— åœæœæ•°æ®è¿ç§»,å¤§ç‰ˆæœ¬å‡çº§ç­‰ã€‚ åŸºæœ¬æ¦‚å¿µ å‘å¸ƒè€…ï¼ˆpublicationï¼‰ï¼Œ ä¸Šæ¸¸æ•°æ® è®¢é˜…è€… (subscrition)ï¼Œ ä¸‹æ¸¸æ•°æ® å¤</description>
    </item>
    
    <item>
      <title>cluster èšæ—è¡¨</title>
      <link>https://zhangeamon.top/postgres/cluster/</link>
      <pubDate>Wed, 30 Jan 2019 15:19:41 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/cluster/</guid>
      <description>å­˜å‚¨æ•°æ®çº¿æ€§ç›¸å…³æ€§ æµ‹è¯•</description>
    </item>
    
    <item>
      <title>Archive walå½’æ¡£</title>
      <link>https://zhangeamon.top/postgres/archive/</link>
      <pubDate>Wed, 30 Jan 2019 14:20:38 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/archive/</guid>
      <description>ä»‹ç» æ‰€è°“WALæ—¥å¿—å½’æ¡£ï¼Œå…¶å®å°±æ˜¯æŠŠåœ¨çº¿çš„WALæ—¥å¿—å¤‡ä»½å‡ºæ¥ã€‚ é…ç½® vi postgresql.conf wal_level=&#39;replica&#39; # - Archiving - archive_mode = on # enables archiving; off, on, or always # (change requires restart) archive_command = &#39;test ! -f /mnt/backup/%f &amp;amp;&amp;amp; cp %p /mnt/backup/%f&#39; # command to use to archive a logfile segment # placeholders: %p = path of file to archive # %f = file name only # e.g. &#39;test ! -f /mnt/server/archivedir/%f &amp;amp;&amp;amp; cp %p /mnt/server/archivedir/%f&#39; #archive_timeout = 0 # force a logfile segment switch after this # number of seconds; 0 disables å‚æ•°è¯´æ˜ wal_level archive æˆ–æ›´é«˜çº§åˆ« archive_mode on å¼€å¯å½’æ¡£æ¨¡å¼ï¼Œalways</description>
    </item>
    
    <item>
      <title>TimescaleDB æ—¶åºæ•°æ®åº“</title>
      <link>https://zhangeamon.top/postgres/timescaledb/</link>
      <pubDate>Wed, 30 Jan 2019 10:20:51 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/timescaledb/</guid>
      <description>æ—¶åºæ•°æ®åº“ https://github.com/timescale/timescaledb æ•°æ®åº“é…ç½® https://github.com/timescale/timescaledb-tune copyå¹¶è¡Œå¯¼å…¥æ•°æ® https://github.com/timescale/timescaledb-parallel-copy å¸¸ç”¨æ–¹æ³• åˆ›å»ºæ‹“å±• CREATE EXTENSION timescaledb; åˆ›å»ºä¸€ä¸ªæ™®é€šçš„è¡¨ CREATE TABLE conditions ( time TIMESTAMPTZ NOT NULL, location TEXT NOT NULL, temperature DOUBLE PRECISION NULL, humidity DOUBLE PRECISION NULL ); è½¬æ¢æˆæ—¶åºæ•°æ®åº“è¡¨ SELECT create_hypertable(&#39;conditions&#39;, &#39;time&#39;); conditions è¡¨å time æ—¶åºå­—æ®µ ä¿®æ”¹æ—¶åºé—´éš” å¯¹æ–°è¡¨ç”Ÿæ•ˆ SELECT set_chunk_time_interval(&#39;conditions&#39;, INTERVAL &#39;24 hours&#39;); æŸ¥çœ‹åˆ†åŒº SELECT show_chunks(&#39;conditions&#39;); SELECT show_chunks(&#39;conditions&#39;, older_than =&amp;gt; INTERVAL &#39;3 months&#39;) SELECT show_chunks(&#39;conditions&#39;, older_than =&amp;gt; DATE &#39;2017-01-01&#39;); SELECT show_chunks(newer_than =&amp;gt; INTERVAL &#39;3 months&#39;); SELECT show_chunks(older_than =&amp;gt; INTERVAL &#39;3 months&#39;, newer_than =&amp;gt; INTERVAL &#39;4 months&#39;); æŸ¥çœ‹æ•°æ®å¤§</description>
    </item>
    
    <item>
      <title>pg_rewind æ—¶é—´çº¿å¯¹é½</title>
      <link>https://zhangeamon.top/postgres/pg_rewind/</link>
      <pubDate>Wed, 30 Jan 2019 10:16:17 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_rewind/</guid>
      <description>pg_rewind requires that the target server either has the wal_log_hints option enabled in postgresql.conf or data checksums enabled when the cluster was initialized with initdb. Neither of these are currently on by default. full_page_writes must also be set to on, but is enabled by default. wal_log_hints ä½¿ç”¨åœºæ™¯ åœ¨æ•°æ®åº“ä¸»ä»ç»“æ„ä¸­ï¼Œä»å˜æˆä¸»æ˜“ã€‚ä½†æ˜¯ç”±ä¸»å˜ä¸ºä»å´éœ€è¦ä¸€ç•ªå‘¨æŠ˜ã€‚ å¦‚æœæ˜¯æ•°æ®é‡å°‘æ—¶é‡æ–°ä½¿ç”¨pg_backupæ‹‰ä¸€ä»½ä»å³å¯ï¼Œä½†æ˜¯å¦‚æœæ•°æ®é‡å¤§æ—¶ï¼Œè¿™ä¸ªè¿‡ç¨‹éå¸¸çš„è€—æ—¶è€—èƒ½ã€‚å¯¹çº¿ä¸Šä¸šåŠ¡ä¹Ÿä¼šæœ‰å½±</description>
    </item>
    
    <item>
      <title>PGé«˜å¯ç”¨Patroni</title>
      <link>https://zhangeamon.top/postgres/patroni/</link>
      <pubDate>Wed, 30 Jan 2019 10:14:55 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/patroni/</guid>
      <description>ç¯å¢ƒ æ“ä½œç³»ç»Ÿ Centos 7 patroni ç‰ˆæœ¬ 2.0.2 postgres ç‰ˆæœ¬ 13 å®ç°ç›®æ ‡ é«˜å¯ç”¨æ–¹æ¡ˆå¯¹æ¯” patroni ç»“æ„åˆ†æ patroni æ­å»ºæ–°é›†ç¾¤ patroni æ¥ç®¡ç°æœ‰é›†ç¾¤ patroni ç®¡ç†pgé…ç½® æ‰‹åŠ¨swithover è‡ªåŠ¨failover ç»´æŠ¤æ¨¡å¼ å¼¹æ€§æ‰©å®¹ï¼Œç¼©å®¹ å¯¹å¤–æä¾›ç»Ÿä¸€æœåŠ¡ RestFULLAPI å¤‡ä»½æ¢å¤ ç›‘æ§ æ—¥å¿— å‡çº§ é«˜å¯ç”¨æ–¹æ¡ˆå¯¹æ¯” pgçš„é«˜å¯ç”¨æ–¹æ¡ˆéƒ½æ˜¯åŸºäºæµå¤åˆ¶æ¥å®ç° PAF pacemaker + corosyns repmgr repmgr æ‰‹åŠ¨æµå¤åˆ¶ç®¡</description>
    </item>
    
    <item>
      <title>citus æ•°æ®åº“åˆ†åº“</title>
      <link>https://zhangeamon.top/postgres/pg_citus/</link>
      <pubDate>Tue, 29 Jan 2019 13:19:26 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_citus/</guid>
      <description>æ•°æ®åº“åˆ†åº“è°ƒç ” Greenplum æ›´é€‚ç”¨äºAPåœºæ™¯ PGXL PGXC ç¤¾åŒºä¸æ´»è·ƒï¼Œæ²Ÿé€šé—®é¢˜åé¦ˆæ—¶é—´é•¿ã€‚æ²¡æ‰¾åˆ°ç”¨æˆ·ç¾¤ä½“. åœ¨æ­¤åŸºç¡€ä¸Šå‘å±•çš„æœ‰äºšä¿¡antdbï¼Œè…¾è®¯tbaseã€‚æ²¡æœ‰é‚£ä¸ªç ”å‘å®åŠ›ï¼Œç®—äº†å§ã€‚ citus æ’ä»¶æ–¹å¼ï¼Œæ— ä¾µå…¥ã€‚å¾ˆå¤šç‰›Xçš„ç‰¹æ€§ä¼ä¸šç‰ˆæ‰æ”¯æŒã€‚ä¸»è¦å¼ºè°ƒå¤šç§Ÿæˆ·ã€‚ mycat mysqlæ”¯æ´¾ï¼Œé˜¿é‡Œå¼€æºï¼ˆæŠ›å¼ƒï¼‰é¡¹ç›®ã€‚ä¸»è¦æ˜¯å¯¹sqlè¯­</description>
    </item>
    
    <item>
      <title>pgwatch2 æ•°æ®åº“æŒ‡æ ‡ç›‘æ§æŸ¥çœ‹</title>
      <link>https://zhangeamon.top/postgres/pgwatch2/</link>
      <pubDate>Tue, 29 Jan 2019 11:19:05 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pgwatch2/</guid>
      <description>ä»‹ç» pgwatch2å®˜æ–¹ å®˜æ–¹æ¼”ç¤ºç¤ºä¾‹ æ¶æ„ agent server agent åœ¨è¢«ç›‘æ§çš„pgä¸Šè‡ªå®šä¹‰æ–¹æ³•ï¼Œç”¨äºæ”¶é›†æ•°æ®åº“ä¿¡æ¯ã€‚è¿™äº›è‡ªå®šä¹‰çš„æ–¹æ³•éœ€è¦ä¾èµ–éœ€è¦æ•°æ®åº“æ‰©å±•å¦‚pg_stat_statements,plpythonu. server è´Ÿè´£å­˜å‚¨æ”¶é›†è¿‡æ¥çš„ä¿¡æ¯ï¼Œå¯ä»¥å­˜æ”¾åœ¨postgresæˆ–influxdbä¸­. å¹¶å°†æ”¶é›†çš„ä¿¡æ¯</description>
    </item>
    
    <item>
      <title>é”æœºåˆ¶</title>
      <link>https://zhangeamon.top/postgres/pg_lock/</link>
      <pubDate>Thu, 24 Jan 2019 11:26:16 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_lock/</guid>
      <description>https://blog.csdn.net/pg_hgdb/article/details/79403651 https://habr.com/en/company/postgrespro/blog/500714/ è¡¨é” https://www.modb.pro/db/26462 æŸ¥çœ‹è¢«å µå¡çš„ä»»åŠ¡ select * from pg_locks where not granted; locktype | database | relation | page | tuple | virtualxid | transactionid | classid | objid | objsubid | virtualtransaction | pid | mode | granted | fastpath ----------+----------+----------+------+-------+------------+---------------+---------+-------+----------+--------------------+-----+------+---------+---------- (0 è¡Œè®°å½•) æŸ¥çœ‹ç­‰å¾…é”ä¿¡æ¯ï¼Œæ˜¯è¢«è°å µå¡äº† select pg_blocking_pids(pid); pg_blocking_pids ------------------ {} ç»ˆæ­¢è¿›ç¨‹ select pg_cancel_backend(pid); # select select pg_terminate_backend(pid); # update insert delete äº‹åŠ¡çš„éš”ç¦»çº§åˆ« Postgres æ•°æ®åº“å…±æœ‰ä¸‰ç§æ•°æ®éš”ç¦»çº§åˆ«ã€‚ Read Commit è¯»çœ‹æäº¤ é»˜è®¤çº§åˆ« åœ¨è¯»å¼€å§‹çš„æ—¶å€™å»ºç«‹æ•°æ®å¿«ç…§ Repeat Read å¯é‡å¤è¯»ã€‚</description>
    </item>
    
    <item>
      <title>æ—¶é—´ç‚¹æ¢å¤</title>
      <link>https://zhangeamon.top/postgres/pitr/</link>
      <pubDate>Thu, 24 Jan 2019 11:08:54 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pitr/</guid>
      <description>PITR Point-in-time recovery https://blog.csdn.net/a964921988/article/details/84957241 https://github.com/digoal/blog/blob/master/201608/20160823_03.md https://github.com/digoal/blog/blob/master/201608/20160823_04.md ä¾èµ–æ¡ä»¶ å†å²å®Œæ•´å¤‡ä»½ ä¸é—´æ–­walæ—¥å¿— ä»¥ä¸Šéƒ½å¯æœ‰wal-g å¤‡ä»½ç³»ç»Ÿæä¾›æ”¯æŒ æ¢å¤åˆ°æŒ‡å®šç‚¹ æŒ‡å®šæ ‡ç­¾ å…·ä½“æ—¶é—´ç‚¹ å…·ä½“äº‹åŠ¡ æŒ‡å®šæ ‡ç­¾ recovery.conf recovery_target_action= &#39;pause&#39; # promote ,shutdown --- æ‰“lable select pg_create_restore_point(&#39;my_daily_process_ended&#39;); --- æ¢å¤åˆ°æŒ‡å®šçš„lable recovery.conf recovery_target_name = &#39;my_daily_process_ended&#39; å…·ä½“æ—¶é—´ restore_command = &#39;cp /data/arch/%f %p&#39; # e.g. &#39;cp /mnt/server/archivedir/%f %p&#39; recovery_target_time = &#39;2020-12-23 09:37:17.010268&#39; recovery_target_inclusive = false recovery_target_timeline = &#39;latest&#39; å…·ä½“äº‹åŠ¡ restore_command = &#39;cp /data/arch/%f %p&#39; # e.g. &#39;cp /mnt/server/archivedir/%f %p&#39; recovery_target_xid = &#39;26897309&#39; recovery_target_inclusive = false</description>
    </item>
    
    <item>
      <title>pg_pathman åˆ†åŒºè¡¨</title>
      <link>https://zhangeamon.top/postgres/pg_pathman/</link>
      <pubDate>Thu, 24 Jan 2019 10:56:06 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_pathman/</guid>
      <description>ä»‹ç» åˆ†åŒºè¡¨çš„è¯‰æ±‚åœ¨ç°å®çš„ç”Ÿæˆä¸­çš„æ„ä¹‰ä¸å¿…å¤šè¯´ï¼Œpgä»¥å‰çš„å®ç°æ–¹å¼å¤šé‡‡ç”¨è§¦å‘å™¨ï¼Œruleså®ç°ã€‚æ•°æ®é‡ä¸Šæ¥æ—¶æ€§èƒ½æ˜æ˜¾ä¸å°½å¦‚æ„ã€‚ è™½ç„¶pg10 ï¼Œ11 ç‰ˆæœ¬åœ¨åˆ†åŒºè¡¨çš„ç‰¹æ€§ä¸Šä¸æ–­å‘åŠ›ã€‚ä½†æ˜¯æ€§èƒ½å•¥è¿˜æ˜¯ä¸å¤Ÿç»™åŠ›ã€‚ pg_pathman åˆ†åŒºè¡¨åŠŸèƒ½åœ¨ç›®å‰çš„pgç‰ˆæœ¬10.6 ä¸­ä¼˜åŠ¿è¿˜æ˜¯éå¸¸æ˜æ˜¾çš„ã€‚ åœ¨æœŸå¾…pgè‡ªèº«åˆ†åŒºè¡¨ç‰¹æ€§çš„</description>
    </item>
    
    <item>
      <title>pgfincore</title>
      <link>https://zhangeamon.top/postgres/pgfincore/</link>
      <pubDate>Fri, 11 Jan 2019 13:17:12 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pgfincore/</guid>
      <description></description>
    </item>
    
    <item>
      <title>pgbench å‹åŠ›æµ‹è¯•</title>
      <link>https://zhangeamon.top/postgres/pgbench/</link>
      <pubDate>Wed, 09 Jan 2019 16:36:47 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pgbench/</guid>
      <description>ä»‹ç» pgbenchæ˜¯ä¸€ç§åœ¨PostgreSQLä¸Šè¿è¡ŒåŸºå‡†æµ‹è¯•çš„ç®€å•ç¨‹åºã€‚ å®˜æ–¹æ–‡æ¡£ é»˜è®¤æµ‹è¯• è‡ªå®šä¹‰æµ‹è¯• é»˜è®¤æµ‹è¯• pgbenchä¸­é»˜è®¤è‡ªå¸¦ä¸€å¥—æµ‹è¯•æ•°æ®åº“å’Œæµ‹è¯•sqlè„šæœ¬ã€‚ åˆå§‹åŒ–é»˜è®¤æ•°æ®åº“ ä½¿ç”¨ -i åˆå§‹åŒ–æ•°æ®åº“ #pgbench -U postgres -i -s 10 pgbenchdb NOTICE: table &amp;quot;pgbench_history&amp;quot; does not exist, skipping NOTICE: table &amp;quot;pgbench_tellers&amp;quot; does not exist, skipping NOTICE: table &amp;quot;pgbench_accounts&amp;quot; does not exist, skipping NOTICE: table &amp;quot;pgbench_branches&amp;quot; does not exist, skipping creating tables... 100000 of 1000000 tuples (10%)</description>
    </item>
    
    <item>
      <title>pg_trgmçš„gistå’Œginç´¢å¼•åŠ é€Ÿå­—ç¬¦åŒ¹é…æŸ¥è¯¢</title>
      <link>https://zhangeamon.top/postgres/pg_trgm/</link>
      <pubDate>Mon, 07 Jan 2019 09:37:23 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_trgm/</guid>
      <description>èƒŒæ™¯ å¯¹è½¦ç‰Œå·çš„è®°å¿†æœ‰æ—¶å¯èƒ½è®°ä½çš„æ˜¯å‰å‡ ä½ï¼Œæœ‰æ—¶å¯èƒ½æ˜¯åå‡ ä½ï¼Œä¸åŒçš„äººè®°è½¦ç‰Œå·çš„ä¹ æƒ¯ä¹Ÿä¸åŒã€‚ é€šå¸¸æ˜¯æ˜¯å®¹æ˜“è®°ä½é¦–å°¾ï¼Œä¸­é—´ä¸æ¸…æ¥šã€‚ é‚£ä¹ˆå¦‚ä½•åœ¨å¤§é‡å·²æœ‰è½¦ç‰Œæ•°æ®ä¸­å¿«é€Ÿæ ¹æ®æ¨¡ç³Šçš„ä¿¡æ¯æ¥è¿›è¡ŒæŸ¥è¯¢å‘¢ï¼Ÿ æ¨¡æ‹Ÿ æ•°æ®åº“è¡¨ä¸­çº¦æœ‰500wæ¡è½¦ç‰Œå·è®°å½•ï¼Œå¯¹è¡¨ä¸­çš„è½¦ç‰Œå·è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ã€‚ å³æ”¯æŒ car_id like &amp;lsquo;%XXXX%XXX%&amp;rsquo; æŸ¥è¯¢ ---åˆ›å»ºè¡¨</description>
    </item>
    
    <item>
      <title>pgbouncer è¿æ¥æ± </title>
      <link>https://zhangeamon.top/postgres/pgbouncer/</link>
      <pubDate>Thu, 27 Dec 2018 09:00:49 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pgbouncer/</guid>
      <description>èƒŒæ™¯ä»‹ç» Pgbounceræ˜¯ä¸€ä¸ªé’ˆå¯¹PostgreSQLæ•°æ®åº“çš„è½»é‡çº§è¿æ¥æ±  pgbouncer çš„ç›®æ ‡æ˜¯é™ä½å› ä¸ºæ–°è¿æ¥åˆ° PostgreSQL çš„è¿æ¥è€Œå¯¼è‡´çš„æ€§èƒ½æŸå¤± ä½¿ç”¨æœ¯è¯­è¯´æ˜ï¼š ä¸ºäº†åé¢çš„æè¿°æ›´æ¸…æ™°ï¼Œä½¿ç”¨å¦‚ä¸‹æœ¯è¯­ Client : æŒ‡è®¿é—®è€… Pgboucer: æŒ‡è¿æ¥æ±  Postgres: æŒ‡æ•°æ®åº“ã€‚ Connetions: æŒ‡å½¼æ­¤ä¹‹é—´çš„è¿æ¥ æ•´ä½“æ¶æ„ åŸæ¥: Client -&amp;gt; Postgres ç°åœ¨: Client -&amp;gt; Pgbounce -&amp;gt; Postgres ä¼˜åŠ¿ å†…å­˜æ¶ˆè€—ä½(é»˜</description>
    </item>
    
    <item>
      <title>å¼•èµ·ç´¢å¼•å¤±æ•ˆ</title>
      <link>https://zhangeamon.top/postgres/index-invalid/</link>
      <pubDate>Thu, 20 Dec 2018 16:34:22 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/index-invalid/</guid>
      <description>ç®€ä»‹ ç´¢å¼•çš„ä½œç”¨ï¼ŒåŠ é€Ÿæ£€ç´¢ï¼Œæ’åºï¼Œåˆ†ç»„ã€‚ ä¼˜ç‚¹ï¼š æ£€ç´¢ ç¼ºç‚¹ï¼š æ–°å¢ï¼Œæ›´æ–°æ—¶éœ€è¦ç»´æŠ¤ç´¢å¼•ï¼Œå ç£ç›˜ç©ºé—´ï¼Œåˆ›å»ºæ—¶é”è¡¨ã€‚ ç»´æŠ¤ï¼š æ ¹æ®ç»Ÿè®¡è¡¨å‘ç”Ÿå…¨è¡¨æ‰«ææ¬¡æ•°ï¼Œç´¢å¼•ä½¿ç”¨æ¬¡æ•°ã€‚åˆç†æ·»åŠ åˆ é™¤ç´¢å¼•ã€‚ ç´¢å¼•å¤±æ•ˆçš„åœºæ™¯ å¦‚æœwhereè¿‡æ»¤æ¡ä»¶è®¾ç½®ä¸åˆç†ï¼Œå³ä½¿ç´¢å¼•å­˜åœ¨ï¼Œä¸”whereè¿‡æ»¤æ¡ä»¶ä¸­åŒ…å«ç´¢å¼•åˆ—ï¼Œä¹Ÿä¼šå¯¼è‡´å…¨è¡¨æ‰«</description>
    </item>
    
    <item>
      <title>æƒé™ç®¡ç†</title>
      <link>https://zhangeamon.top/postgres/role-manager/</link>
      <pubDate>Thu, 20 Dec 2018 09:54:28 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/role-manager/</guid>
      <description>åˆ›å»ºç”¨æˆ· # user ä¸ role åŒºåˆ« ï¼Œ user å…·æœ‰loginæƒé™ postgres=# create user tester with password &#39;123456&#39;; CREATE ROLE åˆ›å»ºæ•°æ®åº“,å¹¶å…³è”æ‰€æœ‰è€… postgres=# create database test owner tester ; CREATE DATABASE å˜æ›´æ•°æ®åº“ç”¨æˆ·æ‰€æœ‰è€… postgres=# alter database test owner to tester; ALTER DATABASE ä¿®æ”¹ç”¨æˆ·&amp;amp;æ•°æ®åº“ #ç”¨æˆ·è¿æ¥æ•° postgres=# alter user tester connection limit 100; ALTER ROLE #æ•°æ®åº“è¿æ¥æ•° postgres=# alter database test connection limit 100; ALTER DATABASE #ç”¨æˆ·å…¶ä»–å±æ€§ä¿®æ”¹ postgres=# alter user tester BYPASSRLS CREATEDB ENCRYPTED PASSWORD LOGIN NOCREATEDB NOINHERIT NOREPLICATION PASSWORD REPLICATION SET VALID UNTIL CONNECTION</description>
    </item>
    
    <item>
      <title>DBA æ—¥å¸¸</title>
      <link>https://zhangeamon.top/postgres/dba/</link>
      <pubDate>Wed, 19 Dec 2018 11:33:43 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/dba/</guid>
      <description>å¤‡ä»½ æ¢å¤ æ—¶æ—¶çƒ­å¤‡ å®šæœŸå†·å¤‡ å‡çº§ æ¯å¹´å¤§ç‰ˆæœ¬å°ç‰ˆæœ¬å‡çº§ï¼Œæ–°ç‰¹æ€§è°ƒç ”ï¼Œæ€§èƒ½æµ‹è¯•ï¼Œç¨³å®šæ€§ã€‚ å¯ç”¨å½“å‰æœ€æ–°çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚ HA æ‰‹åŠ¨ è‡ªåŠ¨ è¯»å†™åˆ†ç¦» sharding å¤šå‰¯æœ¬ å®‰å…¨ æƒé™ç®¡ç† èµ„æºéš”ç¦» å®¡è®¡ ddl æ…¢sql é”é•¿æ—¶é—´å ç”¨ å·¡æ£€ å®šæœŸå·¡æ£€ awr æŠ¥å‘Š ç›‘æ§ ç³»ç»Ÿ æ•°æ®åº“ è¯Šæ–­ ä¼˜åŒ– èƒŒæ™¯ åº”ç”¨ç¨‹åºçš„é‡è›®ç”Ÿé•¿ï¼Œç”±äº§å“ä¸ºé©±åŠ¨çš„å¼€å‘ï¼Œä¸€åˆ‡ä»¥å¿«é€Ÿä¸Šçº¿ä¸ºç›®</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ä¸‰èŒƒå¼äº”çº¦æŸ</title>
      <link>https://zhangeamon.top/postgres/normal-form/</link>
      <pubDate>Mon, 17 Dec 2018 10:27:04 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/normal-form/</guid>
      <description>ä¸‰èŒƒå¼ ç¬¬ä¸€èŒƒå¼ï¼šæ•°æ®è¡¨ä¸­çš„æ¯ä¸€åˆ—ï¼ˆæ¯ä¸ªå­—æ®µï¼‰å¿…é¡»æ˜¯ä¸å¯æ‹†åˆ†çš„æœ€å°å•å…ƒï¼Œä¹Ÿå°±æ˜¯ç¡®ä¿æ¯ä¸€åˆ—çš„åŸå­æ€§ï¼› ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰ï¼šæ»¡è¶³1NFåï¼Œè¦æ±‚è¡¨ä¸­çš„æ‰€æœ‰åˆ—ï¼Œéƒ½å¿…é¡»ä¾èµ–äºä¸»é”®ï¼Œè€Œä¸èƒ½æœ‰ä»»ä½•ä¸€åˆ—ä¸ä¸»é”®æ²¡æœ‰å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªè¡¨åªæè¿°ä¸€ä»¶äº‹æƒ…ï¼› ç¬¬ä¸‰èŒƒå¼ï¼šå¿…é¡»å…ˆæ»¡è¶³ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰ï¼Œè¦æ±‚ï¼šè¡¨ä¸­çš„</description>
    </item>
    
    <item>
      <title>å¿«é€Ÿç”Ÿæˆå¤§é‡æ•°æ®</title>
      <link>https://zhangeamon.top/postgres/insert01/</link>
      <pubDate>Fri, 14 Dec 2018 13:13:57 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/insert01/</guid>
      <description>åœ¨æ•°æ®åº“ä¸­å¿«é€Ÿç”Ÿæˆ1wæ¡æ•°æ®ï¼Œæˆ–æµ‹è¯•æ•°æ®åº“çš„å†™å…¥æ€§èƒ½ã€‚ åˆ›å»ºæ•°æ®åº“è¡¨ postgres=# create table tbl(id int, info text, crt_time timestamp); CREATE TABLE æ–¹æ³•ä¸€ generate_series æŸ¥çœ‹æ–¹æ³•å‡½æ•° postgres=# \df generate_series å‡½æ•°åˆ—è¡¨ æ¶æ„æ¨¡å¼ | åç§° | ç»“æœæ•°æ®ç±»å‹ | å‚æ•°æ•°æ®ç±»å‹ | ç±»å‹ ------------+-----------------+-----------------------------------+--------------------------------------------------------------------+------ pg_catalog | generate_series | SETOF bigint | bigint, bigint | å¸¸è§„ pg_catalog | generate_series | SETOF bigint | bigint, bigint, bigint | å¸¸è§„ pg_catalog | generate_series | SETOF integer | integer, integer | å¸¸è§„ pg_catalog | generate_series | SETOF integer | integer, integer, integer | å¸¸è§„ pg_catalog | generate_series |</description>
    </item>
    
    <item>
      <title>Pipelinedb ç®€ä»‹</title>
      <link>https://zhangeamon.top/postgres/pipelinedb02/</link>
      <pubDate>Wed, 12 Dec 2018 11:39:47 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pipelinedb02/</guid>
      <description>é¡¹ç›®å·²ç»åœæ­¢ç»´æŠ¤ é€‚é…æ”¯æŒç‰ˆæœ¬ PostgreSQL 10: 10.1, 10.2, 10.3, 10.4, 10.5 PostgreSQL 11: 11.0 åŸºæœ¬æ¦‚å¿µ æµ(Stream) æµæ˜¯åŸºç¡€ï¼ŒContinuous Viewså’Œtransformåˆ™æ˜¯åŸºäºæµä¸­çš„æ•°æ®è¿›è¡Œå¤„ç†çš„æ‰‹æ®µã€‚ å¯¹äºåŒä¸€ä»½æ•°æ®ï¼Œåªéœ€è¦å®šä¹‰ä¸€ä¸ªæµï¼Œå†™å…¥ä¸€ä»½å³å¯ã€‚ å¦‚æœå¯¹åŒä¸€ä»½æ•°æ®æœ‰å¤šä¸ªç»´åº¦çš„ç»Ÿè®¡ï¼Œå¯ä»¥å†™åœ¨ä¸€æ¡SQLå®Œæˆçš„ï¼ˆå¦‚åŒ</description>
    </item>
    
    <item>
      <title>Pipelinedbæ–‡æ¡£æ¦‚è§ˆ</title>
      <link>https://zhangeamon.top/postgres/pipelinedb01/</link>
      <pubDate>Wed, 12 Dec 2018 09:46:16 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pipelinedb01/</guid>
      <description>å®˜æ–¹æ–‡æ¡£ ä»‹ç» What PipelineDB is What PipelineDB is not QuitStart ä¸€ä¸ªç»Ÿè®¡wikiæµè§ˆçš„ä¾‹å­ å®‰è£… å„ç§ç¯å¢ƒå®‰è£… Continuous Views å®šä¹‰æµè§†å›¾ï¼Œå…¶å®å°±æ˜¯å®šä¹‰ ç»Ÿè®¡åˆ†æçš„QUERYï¼Œ ä¾‹å¦‚select id, count(*), avg(x), &amp;hellip; from table group by &amp;hellip;; å®šä¹‰å¥½ä¹‹åï¼Œæ•°æ®æ’å…¥tableï¼Œè¿™ä¸ªæµè§†å›¾å°±ä¼šä¸æ–­å¢é‡çš„è¿›è¡Œç»Ÿè®¡ï¼Œä½ åªè¦æŸ¥è¯¢è¿™ä¸ªæµè§†å›¾ï¼Œå°±å¯ä»¥æŸ¥çœ‹åˆ°å®æ—¶çš„ç»Ÿè®¡ç»“æœã€‚ æ•°æ®åº“ä¸­å­˜</description>
    </item>
    
    <item>
      <title>Postgres ç›‘æ§å¸¸ç”¨å·¥å…·</title>
      <link>https://zhangeamon.top/postgres/monitor/</link>
      <pubDate>Thu, 06 Dec 2018 16:21:08 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/monitor/</guid>
      <description>å„ç§ç›‘æ§æ–¹å¼ zabbix Monitor PostgreSQL with Zabbix postgres_exporter A PostgresSQL metric exporter for Prometheus pgwatch2 PostgreSQL metrics monitor/dashboard pgmetrics Collect and display information and stats from a running PostgreSQL server pgdash (æ”¶è´¹) pganalyze PostgreSQL Performance Monitoring å‚è€ƒè‡ªå·±å®ç° çŠ¶æ€æŸ¥çœ‹ pgcenter pgcenter top pgcenter: 2018-12-20 11:10:25, load average: 0.94, 0.84, 0.86 state [ok]: ::1:5432 postgres@postgres (ver: 10.6, up 8 days 19:57:54, recovery: f) %cpu: 15.0 us, 3.7 sy, 0.0 ni, 75.3 id, 5.7 wa, 0.0 hi, 0.2 si, 0.0 st activity: 5/1000 conns, 0/0 prepared, 2 idle, 0 idle_xact, 3 active, 0 waiting, 0 others MiB mem: 7821 total, 162 free, 424 used, 7235 buff/cached autovacuum: 0/3 workers/max, 0 manual, 0 wraparound, 00:00:00 vac_maxtime MiB swap: 1023 total, 903 free, 120 used, 0/0 dirty/writeback statements: 1888 stmt/s,</description>
    </item>
    
    <item>
      <title>tablespace è¡¨ç©ºé—´</title>
      <link>https://zhangeamon.top/postgres/tablespace/</link>
      <pubDate>Thu, 06 Dec 2018 11:17:27 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/tablespace/</guid>
      <description>åŸæ–‡ æ³¨æ„ä¸»ä»æ¶æ„æ—¶ï¼Œä¸»ä»è½¯è¿æ¥ä½ç½®éœ€è¦å¯¹åº”ä¸€è‡´ã€‚ æ€è€ƒï¼š å†·çƒ­æ•°æ®åˆ†ç¦» å†·æ•°æ®å¯¹çƒ­æ•°æ®çš„å½±å“ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶ã€‚</description>
    </item>
    
    <item>
      <title>TOAST æŠ€æœ¯</title>
      <link>https://zhangeamon.top/postgres/toast/</link>
      <pubDate>Thu, 06 Dec 2018 11:14:20 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/toast/</guid>
      <description>åŸæ–‡</description>
    </item>
    
    <item>
      <title>fillfactor å¡«å……å› å­</title>
      <link>https://zhangeamon.top/postgres/fillfactor/</link>
      <pubDate>Thu, 06 Dec 2018 11:01:03 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/fillfactor/</guid>
      <description>ä»‹ç» PostgreSQLæ¯ä¸ªè¡¨å’Œç´¢å¼•çš„æ•°æ®éƒ½æ˜¯ç”±å¾ˆå¤šä¸ªå›ºå®šå°ºå¯¸çš„é¡µé¢å­˜å‚¨ï¼ˆé€šå¸¸æ˜¯ 8kBï¼Œä¸è¿‡åœ¨ç¼–è¯‘æœåŠ¡å™¨æ—¶[â€“with-blocksize]å¯ä»¥é€‰æ‹©å…¶ä»–ä¸åŒçš„å°ºå¯¸ï¼‰ ä¸€ä¸ªè¡¨çš„å¡«å……å› å­(fillfactor)æ˜¯ä¸€ä¸ªä»‹äº 10 å’Œ 100 ä¹‹é—´çš„ç™¾åˆ†æ•°ã€‚100(å®Œå…¨å¡«å……)æ˜¯é»˜è®¤å€¼ã€‚å¦‚æœæŒ‡å®šäº†è¾ƒå°çš„å¡«</description>
    </item>
    
    <item>
      <title>vacuum åƒåœ¾å›æ”¶å™¨</title>
      <link>https://zhangeamon.top/postgres/vacuum/</link>
      <pubDate>Wed, 05 Dec 2018 16:48:00 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/vacuum/</guid>
      <description>ä»‹ç» æ•°æ®åº“æ€»æ˜¯ä¸æ–­åœ°åœ¨æ‰§è¡Œåˆ é™¤ï¼Œæ›´æ–°ç­‰æ“ä½œã€‚è‰¯å¥½çš„ç©ºé—´ç®¡ç†éå¸¸é‡è¦ï¼Œèƒ½å¤Ÿå¯¹æ€§èƒ½å¸¦æ¥å¤§å¹…æé«˜ã€‚åœ¨postgresqlä¸­ç”¨äºç»´æŠ¤æ•°æ®åº“ç£ç›˜ç©ºé—´çš„å·¥å…·æ˜¯VACUUMï¼Œå…¶é‡è¦çš„ä½œç”¨æ˜¯åˆ é™¤é‚£äº›å·²ç»æ ‡ç¤ºä¸ºåˆ é™¤çš„æ•°æ®å¹¶é‡Šæ”¾ç©ºé—´ã€‚ postgresqlä¸­æ‰§è¡Œdelete,updateæ“ä½œåï¼Œè¡¨ä¸­çš„</description>
    </item>
    
    <item>
      <title>Explain æ‰§è¡Œè®¡åˆ’</title>
      <link>https://zhangeamon.top/postgres/explain/</link>
      <pubDate>Wed, 05 Dec 2018 15:27:30 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/explain/</guid>
      <description>æ–‡æ³• EXPLAIN [ ( option [, ...] ) ] statement EXPLAIN [ ANALYZE ] [ VERBOSE ] statement è¿™é‡Œ optionå¯ä»¥æ˜¯ï¼š ANALYZE [ boolean ] VERBOSE [ boolean ] COSTS [ boolean ] BUFFERS [ boolean ] TIMING [ boolean ] SUMMARY [ boolean ] FORMAT { TEXT | XML | JSON | YAML } æ³¨æ„äº‹é¡¹ è®°ä½å½“ä½¿ç”¨äº†ANALYZEé€‰é¡¹æ—¶è¯­å¥ä¼šè¢«å®é™…æ‰§è¡Œ. å¦‚æ‰§è¡Œdml æ—¶å°†å¯¹æ•°æ®åº“è¿›è¡Œå®é™…çš„æ“ä½œã€‚ é¿å…æ±¡æŸ“æ•°æ®çš„æ–¹å¼ BEGIN; EXPLAIN ANALYZE ...; ROLLBACK; ä¸€ä¸ªä¾‹å­ postgres=# explain analyze select * from tbl; QUERY</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“æ—¥å¿—</title>
      <link>https://zhangeamon.top/postgres/log/</link>
      <pubDate>Tue, 04 Dec 2018 15:45:33 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/log/</guid>
      <description>ä»‹ç» PostgreSQLæœ‰3ç§æ—¥å¿—ï¼Œåˆ†åˆ«æ˜¯pg_logï¼ˆæ•°æ®åº“è¿è¡Œæ—¥å¿—ï¼‰ã€pg_xlogï¼ˆWAL æ—¥å¿—ï¼Œå³é‡åšæ—¥å¿—ï¼‰ã€pg_clogï¼ˆäº‹åŠ¡æäº¤æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯äº‹åŠ¡çš„å…ƒæ•°æ®ï¼‰ postgres 10 ç‰ˆæœ¬å°†æ–‡ä»¶ç›®å½•ç»“æ„æ”¹ä¸º logï¼Œpg_walï¼Œpg_xact logé»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦è®¾ç½®å…¶å‚æ•°ã€‚walå’Œxac</description>
    </item>
    
    <item>
      <title>æ¨¡æ¿æ•°æ®åº“</title>
      <link>https://zhangeamon.top/postgres/template/</link>
      <pubDate>Fri, 30 Nov 2018 09:52:43 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/template/</guid>
      <description>æ¨¡æ¿æ•°æ®åº“ æ¨¡æ¿æ•°æ®åº“å°±æ˜¯åˆ›å»ºæ–°databaseæ—¶ï¼ŒPostgreSQLä¼šåŸºäºæ¨¡æ¿æ•°æ®åº“åˆ¶ä½œä¸€ä»½å‰¯æœ¬ï¼Œå…¶ä¸­ä¼šåŒ…å«æ‰€æœ‰çš„æ•°æ®åº“è®¾ç½®å’Œæ•°æ®æ–‡ä»¶ã€‚ PostgreSQLå®‰è£…å¥½ä»¥åä¼šé»˜è®¤é™„å¸¦ä¸¤ä¸ªæ¨¡æ¿æ•°æ®åº“ï¼štemplate0å’Œtemplate1ã€‚ template0 å¹²å‡€ç‰ˆï¼Œä»»ä½•æ—¶å€™ä¸è¦ä¿®æ”¹ template1 é»˜è®¤ç‰ˆï¼Œå¦‚æœåˆ›å»ºæ•°</description>
    </item>
    
    <item>
      <title>pg_stat_statements æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯</title>
      <link>https://zhangeamon.top/postgres/pg_stat_statements/</link>
      <pubDate>Thu, 29 Nov 2018 11:08:27 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/pg_stat_statements/</guid>
      <description>pg_stat_statements æ‰©å±• å®‰è£… yum install postgresql10-contrib.x86_64 ä¿®æ”¹é…ç½®å‚æ•° vi $PGDATA/postgresql.conf shared_preload_libraries=&#39;pg_stat_statements&#39; # åŠ è½½æ¨¡å— éœ€è¦é‡å¯ , è¿‘æœŸæµ‹è¯•ä¸éœ€è¦æ·»åŠ ä¹Ÿå¯ä»¥ã€‚è‡ªå¸¦æ‰©å±• track_io_timing = on # è·Ÿè¸ªIOè€—æ—¶ (å¯é€‰) track_activity_query_size = 2048 # è®¾ç½®å•æ¡SQLçš„æœ€é•¿é•¿åº¦ï¼Œè¶…è¿‡è¢«æˆªæ–­æ˜¾ç¤ºï¼ˆå¯é€‰) pg_stat_statements.max = 10000 #åœ¨pg_stat_statementsä¸­æœ€å¤šä¿ç•™å¤šå°‘æ¡ç»Ÿè®¡ä¿¡æ¯ï¼Œé€šè¿‡LRUç®—æ³•ï¼Œè¦†ç›–è€çš„è®°å½•ã€‚ pg_stat_statements.track = all</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“æ‹“å±•</title>
      <link>https://zhangeamon.top/postgres/extention/</link>
      <pubDate>Tue, 27 Nov 2018 15:20:33 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/extention/</guid>
      <description>æµè®¡ç®—æ•°æ®åº“äº§å“ pipelineDB * æ¨èæ•°æ®åº“äº§å“ recDB æ—¶åºæ•°æ®åº“ timescaleDB * åˆ†å¸ƒå¼æ•°æ®åº“æ’ä»¶ citus * åˆ—å­˜å‚¨æ’ä»¶ IMCS, cstoreç­‰ é¢å‘OLAPçš„codegenæ•°æ®åº“ pg_LLVM å‘é‡è®¡ç®—æ’ä»¶ vops æ•°æ®åº“æ€§èƒ½åˆ†æ pg_stat_statements pg_buffercache ç›´æ¥è®¿é—®æ•°æ®åº“æ–‡ä»¶ç³»ç»Ÿ adminpack åŠ å¯†æ•°æ® pgcrypto é¢„çƒ­ç¼“å­˜ pg_prewarm æ£€æŸ¥å­˜å‚¨ï¼Œç‰¹åˆ«æ˜¯è¡¨è†¨èƒ€ pgstattuple æ¨¡ç³Šæœç´¢ pg_trgm è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨ postgres_fdw kè¿‘é‚»ï¼ˆKNNï¼‰æœç´¢</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å‚æ•°</title>
      <link>https://zhangeamon.top/postgres/params/</link>
      <pubDate>Tue, 27 Nov 2018 09:57:27 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/params/</guid>
      <description>æ€§èƒ½å‚æ•° pgtune pgconfig cybertec æ—¥å¿—å‚æ•° æ›´å¤šå‚æ•°è¯¦è§£ ç®¡ç† listen_addresses = &amp;quot;*&amp;quot; # è¿æ¥è®¿é—®æ§åˆ¶ï¼Œå“ªäº›ipå¯ä»¥è®¿é—®ï¼Œ * å…¨éƒ¨ã€‚ ç»“åˆpg_hba.conf , iptablesè®¾ç½®ã€‚ superuser_reserved_connections = 3 # é¢„ç•™ç»™è¶…çº§ç®¡ç†å‘˜çš„è¿æ¥æ•°ã€‚ port = 5432 # é»˜è®¤è®¿é—®ç«¯å£ wal_keep_segments = 1024 # wal æ—¥å¿—ä¿å­˜æ•°é‡ walæ—¥å¿— wal_log_hints = on full_page_writes = on æˆæœ¬å› å­ # - Planner Cost Constants - #seq_page_cost = 1.0 # measured on an arbitrary scale é¡ºåºæ‰«æ</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“ç´¢å¼•ç±»å‹åŠä½¿ç”¨åœºæ™¯</title>
      <link>https://zhangeamon.top/postgres/index01/</link>
      <pubDate>Mon, 19 Nov 2018 09:00:44 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/index01/</guid>
      <description>ç”¨é€” ä¼˜ç‚¹ ä¸»é”®å”¯ä¸€çº¦æŸ åŠ é€Ÿæ£€ç´¢ æ’åº ç¼ºç‚¹ æ›´æ–°æ•°æ®æ—¶éœ€è¦åŒæ—¶ç»´æŠ¤å¯¹åº”ç´¢å¼• å ç”¨ç£ç›˜ç©ºé—´ï¼Œç”šè‡³æ¯”è¡¨æ•°æ®æœ¬èº«è¿˜è¦å¤š ä½¿ç”¨åœºæ™¯åˆ©å¼Šåˆ†æ TPä¸APåº”ç”¨ è¯»å†™ä½¿ç”¨æ¯”ä¾‹ ç‚¹æŸ¥è¯¢æ‰¹é‡æŸ¥è¯¢ åˆ›å»ºç´¢å¼• \h create index å‘½ä»¤ï¼š CREATE INDEX æè¿°ï¼š å»ºç«‹æ–°çš„ç´¢å¼• è¯­æ³•ï¼š CREATE [ UNIQUE ] INDEX [ CONCURRENTLY ] [ [ IF NOT EXISTS ] åç§° ] ON è¡¨å [ USING æ–¹æ³• ] ( { åˆ—åç§° | ( è¡¨è¾¾å¼ ) }</description>
    </item>
    
    <item>
      <title>PostgresqlæŒ‡æ ‡æŸ¥çœ‹&amp;statç»Ÿè®¡ä¿¡æ¯</title>
      <link>https://zhangeamon.top/postgres/stat/</link>
      <pubDate>Tue, 06 Nov 2018 10:53:52 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/stat/</guid>
      <description>å½“å‰è¿æ¥æ•° SELECT count(*) FROM pg_stat_activity WHERE NOT pid=pg_backend_pid(); count ------- 3 (1 row) æ•°æ®åº“å ç”¨ç©ºé—´ select pg_size_pretty(pg_database_size(&#39;postgres&#39;)); pg_size_pretty ---------------- 14 MB (1 row) or \l+ æ•°æ®åº“è¡¨(ä¸åŒ…æ‹¬ç´¢å¼•)æˆ–å•æ¡ç´¢å¼•å ç”¨ç©ºé—´ select pg_size_pretty(pg_relation_size(&#39;t_name&#39;)); pg_size_pretty ---------------- 24 kB (1 è¡Œè®°å½•) or \d+ è¡¨ä¸­æ‰€æœ‰ç´¢å¼•å æœ‰çš„ç©ºé—´ select pg_size_pretty(pg_indexes_size(&#39;t_name&#39;)); pg_size_pretty ---------------- 280 kB (1 è¡Œè®°å½•) è¡¨ä¸­ç´¢å¼•å ç”¨çš„ç©ºé—´å¤§å°æ’åº select indexname , pg_size_pretty(pg_relation_size(indexname::regclass)) ,indexdef from pg_indexes where tablename = &#39;t_name&#39; order by pg_relation_size(indexname::regclass) desc limit 10; è¡¨å’Œç´¢å¼•å ç”¨æ€»ç©ºé—´ select pg_size_pretty(pg_total_relation_size(&#39;t_name&#39;)); pg_size_pretty ---------------- 380 kB (1 è¡Œè®°å½•) æŸ¥</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å¤‡ä»½å’Œæ¢å¤</title>
      <link>https://zhangeamon.top/postgres/backup_restore/</link>
      <pubDate>Tue, 30 Oct 2018 10:18:57 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/backup_restore/</guid>
      <description>å¤‡ä»½æ¢å¤å‘½ä»¤ å¤‡ä»½ï¼špg_dump -U postgres -v -F c -Z 4 -f ***.backup dbname 9å‹ç¼©ç‡æœ€ç‹  æ¢å¤ï¼špg_restore -U postgres -v -j 8 -d dbname ***.backup 8æ˜¯é‡‡ç”¨8ä¸ªçº¿ç¨‹ æ³¨æ„äº‹é¡¹ï¼š åœ¨æ¢å¤databaseå‰éœ€è¦å…ˆåˆ›å»ºå¥½extentions å¤‡ä»½è¡¨ï¼špg_dump -U postgres -t tablename dbname &amp;gt; 33.sql æ¢å¤è¡¨ï¼špsql -U postgres -d dbname &amp;lt; 33.sql åªå¤‡ä»½è¡¨ç»“æ„ pg_dump -U postgres -s -t tablename dbname &amp;gt;</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å¤‡ä»½å’Œæ¢å¤wal-g åº”ç”¨</title>
      <link>https://zhangeamon.top/postgres/wal-g/</link>
      <pubDate>Tue, 30 Oct 2018 10:18:57 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/wal-g/</guid>
      <description>å­˜å‚¨æœåŠ¡ minio è®¾ç½®ç”¨æˆ·åå’Œå¯†ç  docker run -d -p 9000:9000 -e MINIO_ACCESS_KEY=xxxxx(changeme) -e MINIO_SECRET_KEY=kkkkk(changeme) -v /data/minio/:/data minio/minio server /data åˆ›å»º bucket mc mb local/buecket003 wal-g ä¸‹è½½ wget https://github.com/wal-g/wal-g/releases/download/v0.2.9/wal-g.linux-amd64.tar.gz tar -zxvf wal-g.linux-amd64.tar.gz è®¾ç½®ç¯å¢ƒå˜é‡ minio cat wal-g.env export PGDATA=/var/lib/pgsql/10/data/ export WALG_S3_PREFIX=s3://bucket003/ export PGPORT=5432 export PGUSER=postgres export AWS_SECRET_ACCESS_KEY=xxxxx(changeme) export AWS_REGION=us-east-1 export AWS_ACCESS_KEY_ID=kkkkk(changeme) export AWS_ENDPOINT=http://localhost:9000 export AWS_S3_FORCE_PATH_STYLE=true swift export PGDATA= export WALG_SWIFT_PREFIX=swift://buckt003/ export PGPORT= export PGUSER= export OS_USERNAME= export OS_PASSWORD= export OS_AUTH_URL=http://ip:port/auth/v1.0 å…¨å¤‡ä»½ source mydir/wal-g.env &amp;amp;&amp;amp; wal-g backup-push $PGDATA wal å¤‡ä»½ wal_level = archive archive_mode = on ## ä»åº“ always archive_command = &#39;source mydir/wal-g.env &amp;amp;&amp;amp; wal-g wal-push %p&#39; archive_timeout = 60 æ¢å¤æ•°æ® æŸ¥çœ‹æ‰€æœ‰å…¨å¤‡ä»½ wal-g backup-list name last_modified wal_segment_backup_start base_000000020000001E000000CB 2019-11-07T01:34:08Z 000000020000001E000000CB base_000000020000001E000000CD 2019-11-07T01:37:03Z 000000020000001E000000CD base_000000020000001E000000CF 2019-11-07T02:23:34Z</description>
    </item>
    
    <item>
      <title>ä¸»ä»æµå¤åˆ¶</title>
      <link>https://zhangeamon.top/postgres/replication01/</link>
      <pubDate>Wed, 17 Oct 2018 14:55:38 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/replication01/</guid>
      <description>å†å²æ¼”å˜ replication ä¸»åº“é…ç½® æ ¹æ®å®é™…æƒ…å†µåˆ†é…æµå¤åˆ¶æƒé™ vi pg_hba.conf host replication all 10.2.0.0/0 trust vi postgresql.conf max_wal_senders = 10 wal_level = logical # minimal, replica, or logical hot_standby = on # æ­£å¸¸åœ¨ä»åº“é…ç½®ï¼Œå¦‚æœåœ¨ä¸»åº“é…ç½®å®Œæ¯•ï¼Œå› ä¸ºä»åº“å¤åˆ¶ä¸»åº“é…ç½®ä¸éœ€è¦å†ä¿®æ”¹ä»åº“é…ç½®ã€‚ wal_log_hints = on ä»åº“é…ç½® æ•°æ®åº“å®‰è£… ä»ä¸»åº“å¤åˆ¶æ•°æ® pg_basebackup -h 10.2.0.14 -U postgres -F p -P -R -D /var/lib/pgsql/10/data/ --checkpoint=fast -l postgresback20181219 pg_basebackupæ”¯æŒä¸¤ç§å…¨é‡å¤‡ä»½çš„</description>
    </item>
    
    <item>
      <title>å®‰è£… Postgresql</title>
      <link>https://zhangeamon.top/postgres/install01/</link>
      <pubDate>Wed, 17 Oct 2018 14:37:56 +0800</pubDate>
      
      <guid>https://zhangeamon.top/postgres/install01/</guid>
      <description>å®˜ç½‘ 1.å‡†å¤‡æº æ¸…é™¤å†å²æ®‹ä½™ï¼Œæœ‰äº›æ˜¯ç³»ç»Ÿè‡ªå¸¦çš„æ—§ç‰ˆæœ¬æ•°æ®åº“ rpm -qa | grep postgres rpm -r **** å®‰è£…æ–°æ•°æ®æº yum install https://download.postgresql.org/pub/repos/yum/10/redhat/rhel-7-x86_64/pgdg-centos10-10-2.noarch.rpm yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm å¯å°†æ‰€æœ‰çš„è½¯ä»¶æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬å¦‚ ï¼Œ postgresql-10.2 æ›´æ–°åˆ°å½“å‰æœ€æ–°çš„postgresql-10.6 yum update -y 2.å®‰è£… yum install -y postgresql10-server postgresql10 postgresql10-contrib 3.åˆå§‹åŒ– é»˜è®¤åˆå§‹åŒ– /usr/pgsql-10/bin/postgresql-10-setup initdb å»ºè®®å¼€å¯ checksums sudo su postgres -c &amp;quot;/usr/pgsql-10/bin/initdb --data-checksums -D /var/lib/pgsql/10/data&amp;quot; è‡ªå®šä¹‰ /usr/pgsql-10/bin/initdb -D $PGDATA -U postgres -E UTF-8 --lc-collate=en_US.UTF-8 --lc-ctype=en_US.UTF-8 -k -D</description>
    </item>
    
  </channel>
</rss>
