---
title: "01"
date: 2021-05-12T11:01:34+08:00
draft: true 
toc: false
categories: []
tags: []
---

## 整体需求

#### 三 运维需求

1. 监控方案 ， 前期可用zabbix 对服务器运行情况进行监控

2. 数据库备份， 热备份采用数据库主从复制，冷备份制定周期全数据备份计划。需要个大容量存储硬盘对归档数据进行存储。 对备份数据进行恢复验证

3. 查看机器资源，通过监控系统查看服务器资源。 远程开关机使用远程管理卡

#### 四 技术分析

1. 

2. 客户端与服务器之间的网络分析

3. 授权服务高可用

4. 监控系统 ， zabbix 便于对单个机器的监控，界面展示的是一个机器的所有指标信息，如CPU 内存 温度等。 promethues 便于对监控指标维度的监控  , 比如我只关心CPU温度，界面只展示所有机器的cup信息。

5. 对有公网的服务器进行安全加固，审计

6. 根据技术设计架构采用 nginx ，haproxy 进行负载均衡，服务发现，健康检查。 两台以上负载服务器性能不够时在考虑F5

## 前期工作

2. 机房网络规划：  内网，公网 模式， 

实施步骤 
``` 
  2.1. 内外网模式与端口映射模式共存

  2.2. 内外网模式调通后关闭端口映射

  2.3. 对暴露在外网的服务器安全加固，安全审计
```
备注： 需要新添设备，二层交换机

3. 建立zabbix监控系统。
``` 
3.1.

 zabbix 为类似C/S 模式 需要单独运行服务端。及监控数据库。 服务端程序可与数据库运行在同一个机器上。

备注：根据实际情况看是否需要单独分配监控服务器

3.2

 IPMItool 命令方式管理远程管理卡

 依赖需求 1 服务器支持远程管理卡 2 远程管理卡配置在内网（可与网络规划同时进行） 
```
4. 虚拟化

 采用KVM 进行虚拟化 

具体根据服务器配置和服务运行所需资源情况进行分配，网络采用桥接方式

## nginx 

通过配置nginx 可完成如下功能

#### 功能类

1. 支持 ws 协议 

2. 查看服务实时处理运行状态

3. 限制流量控制，调控服务整体qps能力

4. 限制用户并发数，即同一个IP的并发请求数

5. 访问控制，根据访问IP设置 黑白名单

6. 负载均衡，fair 模式。 将任务分发到最近最少服务的服务器上

7. 服务发现，后端服务(ASR)动态添加,删除

8. backup 备用机, 所有的非backup机器都宕机或者繁忙的时候，才请求backup机器

#### 管理类

1. nginx高可用 keepalive+haproxy ，DNS 轮询 

2. 隐藏nginx版本 属于安全角度

3. 日志记录 ， 切割。 后期可做访问日志分析统计

 


